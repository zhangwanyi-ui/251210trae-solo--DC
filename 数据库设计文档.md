# DC在线业务系统 - 数据库设计文档

## 1. 文档概述

### 1.1 文档目的

本文档详细描述了DC在线业务系统的数据库设计，包括数据库选型、表结构设计、表关系、索引设计等，为后端开发团队提供明确的数据库开发依据，确保系统数据存储合理、结构清晰、性能优良。

### 1.2 术语定义

| 术语 | 解释 |
|------|------|
| ORM | 对象关系映射（Object-Relational Mapping），用于将数据库表映射到程序中的对象 |
| 主键 | 表中的唯一标识符，用于唯一标识一条记录 |
| 外键 | 表中的字段，用于关联其他表的主键 |
| 索引 | 用于提高数据库查询性能的数据结构 |
| 范式 | 数据库设计的规范，用于减少数据冗余和提高数据完整性 |
| RBAC | 基于角色的访问控制（Role-Based Access Control），用于权限管理 |

## 2. 数据库选型

### 2.1 主数据库

| 数据库类型 | 版本 | 选型理由 |
|------------|------|----------|
| MySQL | 8.0+ | 1. 开源免费，社区活跃<br>2. 性能稳定，适合中小型应用<br>3. 支持事务和ACID特性<br>4. 与Node.js和Express框架兼容性好<br>5. 支持丰富的索引类型和查询优化 |

### 2.2 缓存数据库

| 数据库类型 | 版本 | 选型理由 |
|------------|------|----------|
| Redis | 6.0+ | 1. 高性能内存数据库<br>2. 支持多种数据结构（字符串、哈希、列表、集合、有序集合）<br>3. 支持持久化<br>4. 适合缓存热点数据、会话管理、消息队列等场景 |

### 2.3 存储引擎

| 表类型 | 存储引擎 | 选型理由 |
|--------|----------|----------|
| 事务表（用户、角色、权限等） | InnoDB | 1. 支持事务<br>2. 支持行级锁<br>3. 支持外键约束<br>4. 适合高并发读写场景 |
| 非事务表（日志、统计数据等） | MyISAM | 1. 插入速度快<br>2. 适合大量查询场景<br>3. 占用空间小 |

## 3. 数据库设计规范

### 3.1 命名规范

- **数据库名**：使用小写字母，下划线分隔，如 `dc_online_business`
- **表名**：使用小写字母，下划线分隔，如 `sys_user`、`sys_role`
- **字段名**：使用小写字母，下划线分隔，如 `user_id`、`role_name`
- **索引名**：`idx_表名_字段名`，如 `idx_sys_user_username`
- **外键名**：`fk_表名_关联表名`，如 `fk_sys_user_role_id`

### 3.2 数据类型规范

- **字符串**：使用 `VARCHAR`，避免使用 `CHAR`（除非长度固定）
- **整数**：根据实际需求选择 `TINYINT`、`SMALLINT`、`INT`、`BIGINT`
- **时间**：使用 `DATETIME`（精确到秒）或 `TIMESTAMP`（带时区）
- **小数**：使用 `DECIMAL`，避免使用 `FLOAT` 或 `DOUBLE`（精度问题）
- **大文本**：使用 `TEXT` 或 `LONGTEXT`

### 3.3 约束规范

- **主键**：每个表必须有主键，建议使用自增整数或UUID
- **外键**：建立表之间的关联关系，确保数据完整性
- **唯一约束**：确保字段值唯一，如用户名、邮箱、手机号等
- **非空约束**：必填字段添加非空约束
- **默认值**：为字段设置合理的默认值

## 4. 表结构设计

### 4.1 系统管理模块

#### 4.1.1 用户表（sys_user）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| user_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 用户ID |
| username | VARCHAR | 50 | NOT NULL, UNIQUE | 用户名 |
| password | VARCHAR | 255 | NOT NULL | 密码（加密存储） |
| real_name | VARCHAR | 50 | NOT NULL | 真实姓名 |
| email | VARCHAR | 100 | UNIQUE | 邮箱 |
| phone | VARCHAR | 20 | UNIQUE | 手机号码 |
| role_id | BIGINT | 20 | FOREIGN KEY | 角色ID |
| status | TINYINT | 1 | NOT NULL, DEFAULT 1 | 状态（0:禁用, 1:启用） |
| last_login_time | DATETIME | - | NULL | 最后登录时间 |
| last_login_ip | VARCHAR | 50 | NULL | 最后登录IP |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |
| create_by | BIGINT | 20 | FOREIGN KEY | 创建人ID |
| update_by | BIGINT | 20 | FOREIGN KEY | 更新人ID |

**索引**：
- `idx_sys_user_username` (username)
- `idx_sys_user_email` (email)
- `idx_sys_user_phone` (phone)
- `idx_sys_user_role_id` (role_id)

#### 4.1.2 角色表（sys_role）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| role_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 角色ID |
| role_name | VARCHAR | 50 | NOT NULL, UNIQUE | 角色名称 |
| description | TEXT | - | NULL | 角色描述 |
| status | TINYINT | 1 | NOT NULL, DEFAULT 1 | 状态（0:禁用, 1:启用） |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |
| create_by | BIGINT | 20 | FOREIGN KEY | 创建人ID |
| update_by | BIGINT | 20 | FOREIGN KEY | 更新人ID |

**索引**：
- `idx_sys_role_role_name` (role_name)

#### 4.1.3 权限表（sys_permission）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| permission_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 权限ID |
| permission_name | VARCHAR | 100 | NOT NULL, UNIQUE | 权限名称 |
| permission_code | VARCHAR | 100 | NOT NULL, UNIQUE | 权限编码 |
| permission_type | TINYINT | 1 | NOT NULL | 权限类型（1:菜单, 2:按钮, 3:接口） |
| parent_id | BIGINT | 20 | NULL | 父权限ID |
| path | VARCHAR | 255 | NULL | 菜单路径 |
| component | VARCHAR | 255 | NULL | 组件路径 |
| icon | VARCHAR | 50 | NULL | 菜单图标 |
| sort | INT | 10 | NOT NULL, DEFAULT 0 | 排序 |
| status | TINYINT | 1 | NOT NULL, DEFAULT 1 | 状态（0:禁用, 1:启用） |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

**索引**：
- `idx_sys_permission_permission_code` (permission_code)
- `idx_sys_permission_parent_id` (parent_id)

#### 4.1.4 用户角色关联表（sys_user_role）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 关联ID |
| user_id | BIGINT | 20 | FOREIGN KEY | 用户ID |
| role_id | BIGINT | 20 | FOREIGN KEY | 角色ID |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |

**索引**：
- `idx_sys_user_role_user_id` (user_id)
- `idx_sys_user_role_role_id` (role_id)

#### 4.1.5 角色权限关联表（sys_role_permission）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 关联ID |
| role_id | BIGINT | 20 | FOREIGN KEY | 角色ID |
| permission_id | BIGINT | 20 | FOREIGN KEY | 权限ID |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |

**索引**：
- `idx_sys_role_permission_role_id` (role_id)
- `idx_sys_role_permission_permission_id` (permission_id)

### 4.2 业务模块

#### 4.2.1 设备表（device）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| device_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 设备ID |
| device_name | VARCHAR | 100 | NOT NULL | 设备名称 |
| device_code | VARCHAR | 100 | NOT NULL, UNIQUE | 设备编码 |
| device_type | VARCHAR | 50 | NOT NULL | 设备类型 |
| status | TINYINT | 1 | NOT NULL, DEFAULT 1 | 状态（0:离线, 1:在线, 2:故障, 3:维护中） |
| ip_address | VARCHAR | 50 | NOT NULL, UNIQUE | IP地址 |
| mac_address | VARCHAR | 50 | NOT NULL, UNIQUE | MAC地址 |
| location | VARCHAR | 255 | NULL | 设备位置 |
| manufacturer | VARCHAR | 100 | NULL | 制造商 |
| model | VARCHAR | 100 | NULL | 型号 |
| firmware_version | VARCHAR | 50 | NULL | 固件版本 |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |
| last_online_time | DATETIME | - | NULL | 最后在线时间 |

**索引**：
- `idx_device_device_code` (device_code)
- `idx_device_ip_address` (ip_address)
- `idx_device_mac_address` (mac_address)
- `idx_device_status` (status)

#### 4.2.2 指标表（indicator）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| indicator_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 指标ID |
| indicator_name | VARCHAR | 100 | NOT NULL | 指标名称 |
| indicator_code | VARCHAR | 100 | NOT NULL, UNIQUE | 指标编码 |
| device_id | BIGINT | 20 | FOREIGN KEY | 设备ID |
| value | DECIMAL | 18,6 | NOT NULL | 指标值 |
| unit | VARCHAR | 20 | NOT NULL | 单位 |
| collection_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 采集时间 |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |

**索引**：
- `idx_indicator_indicator_code` (indicator_code)
- `idx_indicator_device_id` (device_id)
- `idx_indicator_collection_time` (collection_time)

#### 4.2.3 报警表（alarm）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| alarm_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 报警ID |
| alarm_type | VARCHAR | 50 | NOT NULL | 报警类型 |
| alarm_level | TINYINT | 1 | NOT NULL | 报警级别（1:信息, 2:警告, 3:错误, 4:严重） |
| title | VARCHAR | 255 | NOT NULL | 报警标题 |
| content | TEXT | - | NOT NULL | 报警内容 |
| status | TINYINT | 1 | NOT NULL, DEFAULT 1 | 状态（1:未处理, 2:处理中, 3:已处理, 4:已关闭） |
| device_id | BIGINT | 20 | FOREIGN KEY | 设备ID |
| trigger_condition | TEXT | - | NOT NULL | 触发条件 |
| trigger_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 触发时间 |
| handler_id | BIGINT | 20 | FOREIGN KEY, NULL | 处理人ID |
| handle_time | DATETIME | - | NULL | 处理时间 |
| handle_result | TEXT | - | NULL | 处理结果 |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

**索引**：
- `idx_alarm_device_id` (device_id)
- `idx_alarm_status` (status)
- `idx_alarm_alarm_level` (alarm_level)
- `idx_alarm_trigger_time` (trigger_time)

#### 4.2.4 事件表（event）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| event_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 事件ID |
| event_type | VARCHAR | 50 | NOT NULL | 事件类型 |
| event_level | TINYINT | 1 | NOT NULL | 事件级别（1:信息, 2:警告, 3:错误, 4:严重） |
| title | VARCHAR | 255 | NOT NULL | 事件标题 |
| content | TEXT | - | NOT NULL | 事件内容 |
| impact_scope | VARCHAR | 255 | NULL | 影响范围 |
| device_id | BIGINT | 20 | FOREIGN KEY, NULL | 设备ID |
| user_id | BIGINT | 20 | FOREIGN KEY, NULL | 关联用户ID |
| event_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 事件发生时间 |
| status | TINYINT | 1 | NOT NULL, DEFAULT 1 | 状态（1:待处理, 2:处理中, 3:已处理, 4:已关闭） |
| result | TEXT | - | NULL | 处理结果 |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

**索引**：
- `idx_event_event_type` (event_type)
- `idx_event_status` (status)
- `idx_event_event_level` (event_level)
- `idx_event_event_time` (event_time)
- `idx_event_device_id` (device_id)
- `idx_event_user_id` (user_id)

#### 4.2.5 任务表（task）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| task_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 任务ID |
| task_name | VARCHAR | 100 | NOT NULL | 任务名称 |
| task_type | VARCHAR | 50 | NOT NULL | 任务类型 |
| task_status | TINYINT | 1 | NOT NULL, DEFAULT 1 | 任务状态（1:待执行, 2:执行中, 3:已完成, 4:已失败, 5:已暂停） |
| executor_id | BIGINT | 20 | FOREIGN KEY, NULL | 执行人ID |
| content | TEXT | - | NOT NULL | 任务内容 |
| start_time | DATETIME | - | NULL | 开始时间 |
| end_time | DATETIME | - | NULL | 结束时间 |
| expected_completion_time | DATETIME | - | NOT NULL | 预计完成时间 |
| actual_completion_time | DATETIME | - | NULL | 实际完成时间 |
| progress | INT | 3 | NOT NULL, DEFAULT 0 | 进度（0-100） |
| result | TEXT | - | NULL | 任务结果 |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |
| create_by | BIGINT | 20 | FOREIGN KEY | 创建人ID |
| update_by | BIGINT | 20 | FOREIGN KEY | 更新人ID |

**索引**：
- `idx_task_task_status` (task_status)
- `idx_task_executor_id` (executor_id)
- `idx_task_expected_completion_time` (expected_completion_time)

### 4.3 日志模块

#### 4.3.1 操作日志表（sys_operation_log）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| log_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 日志ID |
| user_id | BIGINT | 20 | FOREIGN KEY | 用户ID |
| username | VARCHAR | 50 | NOT NULL | 用户名 |
| operation | VARCHAR | 255 | NOT NULL | 操作内容 |
| method | VARCHAR | 10 | NOT NULL | 请求方法 |
| url | VARCHAR | 255 | NOT NULL | 请求URL |
| ip | VARCHAR | 50 | NOT NULL | IP地址 |
| user_agent | TEXT | - | NULL | 用户代理 |
| params | TEXT | - | NULL | 请求参数 |
| result | TEXT | - | NULL | 操作结果 |
| status | TINYINT | 1 | NOT NULL | 操作状态（1:成功, 0:失败） |
| error_msg | TEXT | - | NULL | 错误信息 |
| execution_time | INT | 10 | NOT NULL | 执行时间（毫秒） |
| create_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |

**索引**：
- `idx_sys_operation_log_user_id` (user_id)
- `idx_sys_operation_log_create_time` (create_time)
- `idx_sys_operation_log_status` (status)

#### 4.3.2 登录日志表（sys_login_log）

| 字段名 | 字段类型 | 长度 | 约束 | 描述 |
|--------|----------|------|------|------|
| log_id | BIGINT | 20 | PRIMARY KEY, AUTO_INCREMENT | 日志ID |
| username | VARCHAR | 50 | NOT NULL | 用户名 |
| ip | VARCHAR | 50 | NOT NULL | IP地址 |
| user_agent | TEXT | - | NULL | 用户代理 |
| login_time | DATETIME | - | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 登录时间 |
| status | TINYINT | 1 | NOT NULL | 登录状态（1:成功, 0:失败） |
| error_msg | VARCHAR | 255 | NULL | 错误信息 |

**索引**：
- `idx_sys_login_log_username` (username)
- `idx_sys_login_log_login_time` (login_time)
- `idx_sys_login_log_status` (status)

## 5. 表关系图

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│    sys_user     │     │    sys_role     │     │ sys_permission  │
├─────────────────┤     ├─────────────────┤     ├─────────────────┤
│ user_id (PK)    │<───┐│ role_id (PK)    │<───┐│ permission_id(PK)│
│ username        │    ││ role_name       │    ││ permission_name │
│ password        │    ││ description     │    ││ permission_code │
│ real_name       │    ││ status          │    ││ permission_type │
│ email           │    ││ create_time     │    ││ parent_id       │
│ phone           │    ││ update_time     │    ││ path            │
│ role_id (FK)    │────┘│ create_by       │    ││ component       │
│ status          │     │ update_by       │    ││ icon            │
│ last_login_time │     └─────────────────┘    ││ sort            │
│ last_login_ip   │                             ││ status          │
│ create_time     │                             ││ create_time     │
│ update_time     │                             ││ update_time     │
│ create_by       │                             └─────────────────┘
│ update_by       │                                   ▲
└─────────────────┘                                   │
        ▲                                             │
        │                                             │
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│sys_user_role    │     │sys_role_permission│     │     device      │
├─────────────────┤     ├─────────────────┤     ├─────────────────┤
│ id (PK)         │     │ id (PK)         │     │ device_id (PK)  │
│ user_id (FK)    │─────┘│ role_id (FK)    │─────┘│ device_name     │
│ role_id (FK)    │───────┐│ permission_id(FK)│     │ device_code     │
│ create_time     │     └─────────────────┘     │ device_type     │
└─────────────────┘                             │ status          │
        │                                       │ ip_address      │
        │                                       │ mac_address     │
        │                                       │ location        │
        │                                       │ manufacturer    │
        │                                       │ model           │
        │                                       │ firmware_version│
        │                                       │ create_time     │
        │                                       │ update_time     │
        │                                       │ last_online_time│
        │                                       └─────────────────┘
        │                                               ▲
        │                                               │
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│   sys_log       │     │     alarm       │     │   indicator     │
├─────────────────┤     ├─────────────────┤     ├─────────────────┤
│ log_id (PK)     │     │ alarm_id (PK)   │     │ indicator_id(PK)│
│ user_id (FK)    │     │ alarm_type      │     │ indicator_name  │
│ operation       │     │ alarm_level     │     │ indicator_code  │
│ method          │     │ title           │     │ device_id (FK)  │
│ url             │     │ content         │     │ value           │
│ ip              │     │ status          │     │ unit            │
│ user_agent      │     │ device_id (FK)  │─────┘│ collection_time │
│ params          │     │ trigger_condition│     │ create_time     │
│ result          │     │ trigger_time    │     └─────────────────┘
│ status          │     │ handler_id (FK) │             ▲
│ error_msg       │     │ handle_time     │             │
│ execution_time  │     │ handle_result   │             │
│ create_time     │     │ create_time     │             │
└─────────────────┘     │ update_time     │             │
                        └─────────────────┘             │
                                │                       │
                                │                       │
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│     event       │     │     task        │     │ sys_config      │
├─────────────────┤     ├─────────────────┤     ├─────────────────┤
│ event_id (PK)   │     │ task_id (PK)    │     │ config_id (PK)  │
│ event_type      │     │ task_name       │     │ config_key      │
│ event_level     │     │ task_type       │     │ config_value    │
│ title           │     │ task_status     │     │ description     │
│ content         │     │ executor_id (FK)│     │ create_time     │
│ impact_scope    │     │ content         │     │ update_time     │
│ device_id (FK)  │─────┘│ start_time      │     └─────────────────┘
│ user_id (FK)    │───────┐│ end_time        │
│ event_time      │     ││ expected_completion_time│
│ status          │     ││ actual_completion_time │
│ result          │     ││ progress         │
│ create_time     │     ││ result           │
│ update_time     │     ││ create_time      │
└─────────────────┘     ││ update_time      │
                        ││ create_by        │
                        ││ update_by        │
                        └─────────────────┘
```

## 6. 数据库连接配置

### 6.1 开发环境

```json
{
  "host": "localhost",
  "port": 3306,
  "database": "dc_online_business_dev",
  "username": "root",
  "password": "password",
  "dialect": "mysql",
  "timezone": "+08:00",
  "logging": true
}
```

### 6.2 测试环境

```json
{
  "host": "localhost",
  "port": 3306,
  "database": "dc_online_business_test",
  "username": "root",
  "password": "password",
  "dialect": "mysql",
  "timezone": "+08:00",
  "logging": true
}
```

### 6.3 生产环境

```json
{
  "host": "localhost",
  "port": 3306,
  "database": "dc_online_business_prod",
  "username": "dc_user",
  "password": "password",
  "dialect": "mysql",
  "timezone": "+08:00",
  "logging": false
}
```

## 7. 数据库优化建议

### 7.1 索引优化

- 为经常查询的字段创建索引
- 避免在索引字段上使用函数或表达式
- 避免创建过多索引，影响插入和更新性能
- 考虑使用复合索引，覆盖常用查询

### 7.2 查询优化

- 避免使用 `SELECT *`，只查询需要的字段
- 使用 `LIMIT` 限制返回结果数量
- 避免在 `WHERE` 子句中使用 `OR`，考虑使用 `UNION` 替代
- 避免使用 `%` 开头的模糊查询

### 7.3 表结构优化

- 合理设计表结构，避免冗余字段
- 使用合适的数据类型，避免存储空间浪费
- 考虑分表分库，处理大数据量
- 定期优化表，使用 `OPTIMIZE TABLE` 命令

### 7.4 事务优化

- 尽量缩短事务执行时间
- 避免在事务中执行不必要的操作
- 考虑使用读写分离，提高并发性能

## 8. 数据迁移和备份策略

### 8.1 数据迁移

- 使用 Sequelize 的迁移功能进行数据库结构变更
- 编写迁移脚本，确保数据一致性
- 测试环境验证后再应用到生产环境

### 8.2 数据备份

- **全量备份**：每天凌晨执行一次全量备份
- **增量备份**：每小时执行一次增量备份
- **日志备份**：实时备份二进制日志
- **备份存储**：备份文件存储在不同的物理位置，定期验证备份的完整性

### 8.3 恢复策略

- 定期测试数据恢复流程
- 制定详细的恢复计划，包括恢复步骤、时间预估、验证方法等
- 确保恢复操作不会影响生产环境

## 9. 附录

### 9.1 数据字典

| 模块 | 表名 | 主要功能 |
|------|------|----------|
| 系统管理 | sys_user | 用户信息管理 |
| 系统管理 | sys_role | 角色信息管理 |
| 系统管理 | sys_permission | 权限信息管理 |
| 系统管理 | sys_user_role | 用户角色关联 |
| 系统管理 | sys_role_permission | 角色权限关联 |
| 业务模块 | device | 设备信息管理 |
| 业务模块 | indicator | 指标数据管理 |
| 业务模块 | alarm | 报警信息管理 |
| 业务模块 | event | 事件信息管理 |
| 业务模块 | task | 任务信息管理 |
| 日志模块 | sys_operation_log | 操作日志管理 |
| 日志模块 | sys_login_log | 登录日志管理 |

### 9.2 数据库设计工具

- MySQL Workbench
- Navicat for MySQL
- ERMaster
- PowerDesigner

### 9.3 联系方式

| 角色 | 姓名 | 联系方式 |
|------|------|----------|
| 数据库管理员 | XXX | XXX@example.com |
| 后端开发负责人 | XXX | XXX@example.com |
| 产品经理 | XXX | XXX@example.com |