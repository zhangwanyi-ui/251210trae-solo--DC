{"version":3,"file":"index.umd.min.js","sources":["../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/typeof.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/createClass.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/is-nil.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/is-string.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/clamp.js","../../../node_modules/.pnpm/gl-matrix@3.4.4/node_modules/gl-matrix/esm/common.js","../../../node_modules/.pnpm/gl-matrix@3.4.4/node_modules/gl-matrix/esm/mat4.js","../src/components/ElementSVG.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../src/shapes/paths/Image.ts","../src/shapes/paths/Line.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../src/shapes/paths/Path.ts","../src/shapes/paths/Polyline.ts","../src/shapes/paths/Rect.ts","../src/utils/dom.ts","../src/shapes/defs/Filter.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../src/shapes/defs/Pattern.ts","../src/shapes/defs/DefElementManager.ts","../src/shapes/defs/Shadow.ts","../src/utils/format.ts","../src/SVGRendererPlugin.ts","../src/shapes/paths/Text.ts","../src/DefaultElementLifeCycleContribution.ts","../src/index.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/callSuper.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/inherits.js"],"sourcesContent":["function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nexport { _classCallCheck as default };","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","function _getPrototypeOf(t) {\n  return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, _getPrototypeOf(t);\n}\nexport { _getPrototypeOf as default };","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (_isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  })();\n}\nexport { _isNativeReflectConstruct as default };","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nexport { _possibleConstructorReturn as default };","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nexport { _assertThisInitialized as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","/**\n * 判断值是否为 null 或 undefined\n * @return 是否为 null 或 undefined\n */\nexport default function isNil(value) {\n    return value === null || value === undefined;\n}\n//# sourceMappingURL=is-nil.js.map","/**\n * 判断值是否为字符串\n * @return 是否为字符串\n */\nexport default function isString(value) {\n    return typeof value === 'string';\n}\n//# sourceMappingURL=is-string.js.map","var clamp = function (a, min, max) {\n    if (a < min) {\n        return min;\n    }\n    else if (a > max) {\n        return max;\n    }\n    return a;\n};\nexport default clamp;\n//# sourceMappingURL=clamp.js.map","/**\n * Common utilities\n * @module glMatrix\n */\n\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== \"undefined\" ? Float32Array : Array;\nexport var RANDOM = Math.random;\nexport var ANGLE_ORDER = \"zyx\";\n\n/**\n * Symmetric round\n * see https://www.npmjs.com/package/round-half-up-symmetric#user-content-detailed-background\n *\n * @param {Number} a value to round\n */\nexport function round(a) {\n  if (a >= 0) return Math.round(a);\n  return a % 0.5 === 0 ? Math.floor(a) : Math.round(a);\n}\n\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\nvar radian = 180 / Math.PI;\n\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\nexport function toRadian(a) {\n  return a * degree;\n}\n\n/**\n * Convert Radian To Degree\n *\n * @param {Number} a Angle in Radians\n */\nexport function toDegree(a) {\n  return a * radian;\n}\n\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a          The first number to test.\n * @param {Number} b          The second number to test.\n * @param {Number} tolerance  Absolute or relative tolerance (default glMatrix.EPSILON)\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nexport function equals(a, b) {\n  var tolerance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : EPSILON;\n  return Math.abs(a - b) <= tolerance * Math.max(1, Math.abs(a), Math.abs(b));\n}","import * as glMatrix from \"./common.js\";\n\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n    var a12 = a[6],\n      a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n\n  // Calculate the determinant\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function adjoint(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n  out[0] = a11 * b11 - a12 * b10 + a13 * b09;\n  out[1] = a02 * b10 - a01 * b11 - a03 * b09;\n  out[2] = a31 * b05 - a32 * b04 + a33 * b03;\n  out[3] = a22 * b04 - a21 * b05 - a23 * b03;\n  out[4] = a12 * b08 - a10 * b11 - a13 * b07;\n  out[5] = a00 * b11 - a02 * b08 + a03 * b07;\n  out[6] = a32 * b02 - a30 * b05 - a33 * b01;\n  out[7] = a20 * b05 - a22 * b02 + a23 * b01;\n  out[8] = a10 * b10 - a11 * b08 + a13 * b06;\n  out[9] = a01 * b08 - a00 * b10 - a03 * b06;\n  out[10] = a30 * b04 - a31 * b02 + a33 * b00;\n  out[11] = a21 * b02 - a20 * b04 - a23 * b00;\n  out[12] = a11 * b07 - a10 * b09 - a12 * b06;\n  out[13] = a00 * b09 - a01 * b07 + a02 * b06;\n  out[14] = a31 * b01 - a30 * b03 - a32 * b00;\n  out[15] = a20 * b03 - a21 * b01 + a22 * b00;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b0 = a00 * a11 - a01 * a10;\n  var b1 = a00 * a12 - a02 * a10;\n  var b2 = a01 * a12 - a02 * a11;\n  var b3 = a20 * a31 - a21 * a30;\n  var b4 = a20 * a32 - a22 * a30;\n  var b5 = a21 * a32 - a22 * a31;\n  var b6 = a00 * b5 - a01 * b4 + a02 * b3;\n  var b7 = a10 * b5 - a11 * b4 + a12 * b3;\n  var b8 = a20 * b2 - a21 * b1 + a22 * b0;\n  var b9 = a30 * b2 - a31 * b1 + a32 * b0;\n\n  // Calculate the determinant\n  return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\n}\n\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n\n  // Cache only the current line of the second matrix\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\nexport function translate(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n  return out;\n}\n\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\nexport function scale(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11];\n\n  // Construct the elements of the rotation matrix\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw;\n  //Only scale if it makes sense\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion parameter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  return out;\n}\n\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n  return out;\n}\n\n/**\n * Decomposes a transformation matrix into its rotation, translation\n * and scale components. Returns only the rotation component\n * @param  {quat} out_r Quaternion to receive the rotation component\n * @param  {vec3} out_t Vector to receive the translation vector\n * @param  {vec3} out_s Vector to receive the scaling factor\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @returns {quat} out_r\n */\nexport function decompose(out_r, out_t, out_s, mat) {\n  out_t[0] = mat[12];\n  out_t[1] = mat[13];\n  out_t[2] = mat[14];\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out_s[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out_s[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out_s[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  var is1 = 1 / out_s[0];\n  var is2 = 1 / out_s[1];\n  var is3 = 1 / out_s[2];\n  var sm11 = m11 * is1;\n  var sm12 = m12 * is2;\n  var sm13 = m13 * is3;\n  var sm21 = m21 * is1;\n  var sm22 = m22 * is2;\n  var sm23 = m23 * is3;\n  var sm31 = m31 * is1;\n  var sm32 = m32 * is2;\n  var sm33 = m33 * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out_r[3] = 0.25 * S;\n    out_r[0] = (sm23 - sm32) / S;\n    out_r[1] = (sm31 - sm13) / S;\n    out_r[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out_r[3] = (sm23 - sm32) / S;\n    out_r[0] = 0.25 * S;\n    out_r[1] = (sm12 + sm21) / S;\n    out_r[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out_r[3] = (sm31 - sm13) / S;\n    out_r[0] = (sm12 + sm21) / S;\n    out_r[1] = 0.25 * S;\n    out_r[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out_r[3] = (sm12 - sm21) / S;\n    out_r[0] = (sm31 + sm13) / S;\n    out_r[1] = (sm23 + sm32) / S;\n    out_r[2] = 0.25 * S;\n  }\n  return out_r;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     mat4.translate(dest, dest, origin);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *     mat4.translate(dest, dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\nexport function fromQuat(out, q) {\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n  return out;\n}\n\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\nexport var perspective = perspectiveNO;\n\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\nexport var ortho = orthoNO;\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} target Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n    eyey = eye[1],\n    eyez = eye[2],\n    upx = up[0],\n    upy = up[1],\n    upz = up[2];\n  var z0 = eyex - target[0],\n    z1 = eyey - target[1],\n    z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n  var x0 = upy * z2 - upz * z1,\n    x1 = upz * z0 - upx * z2,\n    x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + a[6] * a[6] + a[7] * a[7] + a[8] * a[8] + a[9] * a[9] + a[10] * a[10] + a[11] * a[11] + a[12] * a[12] + a[13] * a[13] + a[14] * a[14] + a[15] * a[15]);\n}\n\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7];\n  var a8 = a[8],\n    a9 = a[9],\n    a10 = a[10],\n    a11 = a[11];\n  var a12 = a[12],\n    a13 = a[13],\n    a14 = a[14],\n    a15 = a[15];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  var b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7];\n  var b8 = b[8],\n    b9 = b[9],\n    b10 = b[10],\n    b11 = b[11];\n  var b12 = b[12],\n    b13 = b[13],\n    b14 = b[14],\n    b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\nexport var sub = subtract;","export class ElementSVG {\n  static tag = 'c-svg-element';\n\n  /**\n   * basic element, eg. <circle>|<ellipse>\n   */\n  $el: SVGElement | null;\n\n  /**\n   * group wrapper for basic element, eg. <g><circle /></g>.\n   * if current element is <g>, same as `$el`\n   */\n  $groupEl: SVGElement | null;\n\n  /**\n   * hitArea:\n   * $groupEl -> $el\n   *          -> $hitTestingEl\n   */\n  $hitTestingEl: SVGElement | null;\n}\n","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import type { ParsedImageStyleProps } from '@antv/g-lite';\nimport { isString } from '@antv/util';\n\nexport function updateImageElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedImageStyleProps,\n) {\n  const { src = '', x = 0, y = 0, width, height } = parsedStyle;\n\n  $el.setAttribute('x', `${x}`);\n  $el.setAttribute('y', `${y}`);\n\n  if (isString(src)) {\n    $el.setAttribute('href', src);\n  } else if (src instanceof Image) {\n    if (!width) {\n      $el.setAttribute('width', `${src.width}`);\n    }\n    if (!height) {\n      $el.setAttribute('height', `${src.height}`);\n    }\n    $el.setAttribute('href', src.src);\n  } else if (\n    // @ts-ignore\n    src instanceof HTMLElement &&\n    isString((src as HTMLElement).nodeName) &&\n    (src as HTMLElement).nodeName.toUpperCase() === 'CANVAS'\n  ) {\n    $el.setAttribute('href', (src as HTMLCanvasElement).toDataURL());\n    // @ts-ignore\n  } else if (src instanceof ImageData) {\n    const canvas = document.createElement('canvas');\n    // @ts-ignore\n    canvas.setAttribute('width', `${src.width}`);\n    // @ts-ignore\n    canvas.setAttribute('height', `${src.height}`);\n    const context = canvas.getContext('2d');\n    if (context) {\n      context.putImageData(src, 0, 0);\n      if (!width) {\n        // @ts-ignore\n        $el.setAttribute('width', `${src.width}`);\n      }\n      if (!height) {\n        // @ts-ignore\n        $el.setAttribute('height', `${src.height}`);\n      }\n      $el.setAttribute('href', canvas.toDataURL());\n    }\n  }\n}\n","import type { ParsedLineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function updateLineElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedLineStyleProps,\n) {\n  const {\n    x1,\n    y1,\n    x2,\n    y2,\n    markerStart,\n    markerEnd,\n    markerStartOffset,\n    markerEndOffset,\n  } = parsedStyle;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = x2 - x1;\n    y = y2 - y1;\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = x1 - x2;\n    y = y1 - y2;\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  // @see https://github.com/antvis/g/issues/1038\n  $el.setAttribute('x1', `${x1 + startOffsetX}`);\n  $el.setAttribute('y1', `${y1 + startOffsetY}`);\n  $el.setAttribute('x2', `${x2 + endOffsetX}`);\n  $el.setAttribute('y2', `${y2 + endOffsetY}`);\n}\n","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nexport { _arrayLikeToArray as default };","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nexport { _slicedToArray as default };","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nexport { _arrayWithHoles as default };","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nexport { _iterableToArrayLimit as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nexport { _unsupportedIterableToArray as default };","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableRest as default };","import type { ParsedPathStyleProps, Path } from '@antv/g-lite';\nimport { isDisplayObject, translatePathToString } from '@antv/g-lite';\n\nexport function updatePathElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedPathStyleProps,\n) {\n  const { d, markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    const [p1, p2] = (markerStart.parentNode as Path).getStartTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    const [p1, p2] = (markerEnd.parentNode as Path).getEndTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  $el.setAttribute(\n    'd',\n    translatePathToString(\n      d.absolutePath,\n      startOffsetX,\n      startOffsetY,\n      endOffsetX,\n      endOffsetY,\n    ),\n  );\n}\n","import type { ParsedPolylineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function updatePolylineElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedPolylineStyleProps,\n) {\n  const {\n    points: { points },\n    markerStart,\n    markerStartOffset,\n    markerEnd,\n    markerEndOffset,\n  } = parsedStyle;\n  const { length } = points;\n\n  if (points && length >= 2) {\n    let startOffsetX = 0;\n    let startOffsetY = 0;\n    let endOffsetX = 0;\n    let endOffsetY = 0;\n\n    let rad = 0;\n    let x: number;\n    let y: number;\n\n    if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n      x = points[1][0] - points[0][0];\n      y = points[1][1] - points[0][1];\n      rad = Math.atan2(y, x);\n      startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n      startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n    }\n\n    if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n      x = points[length - 2][0] - points[length - 1][0];\n      y = points[length - 2][1] - points[length - 1][1];\n      rad = Math.atan2(y, x);\n      endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n      endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n    }\n\n    $el.setAttribute(\n      'points',\n      points\n        .map((point: [number, number], i) => {\n          let offsetX = 0;\n          let offsetY = 0;\n          if (i === 0) {\n            offsetX = startOffsetX;\n            offsetY = startOffsetY;\n          } else if (i === length - 1) {\n            offsetX = endOffsetX;\n            offsetY = endOffsetY;\n          }\n          return `${point[0] + offsetX},${point[1] + offsetY}`;\n        })\n        .join(' '),\n    );\n  }\n}\n","import type { ParsedRectStyleProps } from '@antv/g-lite';\nimport { clamp } from '@antv/util';\n\nexport function updateRectElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedRectStyleProps,\n) {\n  const { radius, x = 0, y = 0, width, height } = parsedStyle;\n\n  // CSSKeyword: auto\n  if (!isFinite(width) || !isFinite(height)) {\n    return;\n  }\n\n  const hasRadius = radius && radius.some((r) => r !== 0);\n\n  let d = '';\n  if (!hasRadius) {\n    d = `M ${x},${y} l ${width},0 l 0,${height} l${-width} 0 z`;\n  } else {\n    const [tlr, trr, brr, blr] = radius.map((r) =>\n      clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2)),\n    );\n\n    const signX = width > 0 ? 1 : -1;\n    const signY = height > 0 ? 1 : -1;\n    // sweep-flag @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths#arcs\n    const sweepFlag = signX + signY !== 0 ? 1 : 0;\n    d = [\n      [`M ${signX * tlr + x},${y}`],\n      [`l ${width - signX * (tlr + trr)},0`],\n      [`a ${trr},${trr},0,0,${sweepFlag},${signX * trr},${signY * trr}`],\n      [`l 0,${height - signY * (trr + brr)}`],\n      [`a ${brr},${brr},0,0,${sweepFlag},${-signX * brr},${signY * brr}`],\n      [`l ${signX * (brr + blr) - width},0`],\n      [`a ${blr},${blr},0,0,${sweepFlag},${-signX * blr},${-signY * blr}`],\n      [`l 0,${signY * (blr + tlr) - height}`],\n      [`a ${tlr},${tlr},0,0,${sweepFlag},${signX * tlr},${-signY * tlr}`],\n      ['z'],\n    ].join(' ');\n  }\n  $el.setAttribute('d', d);\n}\n","export function createSVGElement(type: string, doc?: Document): SVGElement {\n  return (doc || document).createElementNS('http://www.w3.org/2000/svg', type);\n}\n","import type {\n  CSSUnitValue,\n  DisplayObject,\n  ParsedBaseStyleProps,\n} from '@antv/g-lite';\nimport { UnitType } from '@antv/g-lite';\nimport { createSVGElement } from '../../utils/dom';\n\nexport const FILTER_PREFIX = 'g-filter-';\n\n/**\n * use SVG filters, eg. blur, brightness, contrast...\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/filter\n */\nexport function createOrUpdateFilter(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  filters: ParsedBaseStyleProps['filter'],\n) {\n  // eg. filter=\"url(#f1) url(#f2)\"\n  const filterName = FILTER_PREFIX + object.entity;\n\n  const $existedFilters = $def.querySelectorAll(`[name=${filterName}]`);\n  if ($existedFilters.length) {\n    $existedFilters.forEach(($filter) => {\n      $def.removeChild($filter);\n    });\n  }\n\n  if (filters.length === 0) {\n    // 'none'\n    $el?.removeAttribute('filter');\n  } else {\n    const filterIds = filters.map(({ name, params }, i) => {\n      const $filter = createSVGElement('filter', document) as SVGFilterElement;\n      // @see https://github.com/antvis/g/issues/1025\n      $filter.setAttribute('filterUnits', 'userSpaceOnUse');\n      if (name === 'blur') {\n        createBlur(document, $filter, params);\n      } else if (name === 'brightness') {\n        createBrightness(document, $filter, params);\n      } else if (name === 'drop-shadow') {\n        createDropShadow(document, $filter, params);\n      } else if (name === 'contrast') {\n        createContrast(document, $filter, params);\n      } else if (name === 'grayscale') {\n        createGrayscale(document, $filter, params);\n      } else if (name === 'sepia') {\n        createSepia(document, $filter, params);\n      } else if (name === 'saturate') {\n        createSaturate(document, $filter, params);\n      } else if (name === 'hue-rotate') {\n        createHueRotate(document, $filter, params);\n      } else if (name === 'invert') {\n        createInvert(document, $filter, params);\n      }\n\n      $filter.id = `${filterName}-${i}`;\n      $filter.setAttribute('name', filterName);\n      $def.appendChild($filter);\n\n      return $filter.id;\n    });\n\n    // @see https://github.com/antvis/G/issues/1114\n    setTimeout(() => {\n      $el?.setAttribute(\n        'filter',\n        filterIds.map((filterId) => `url(#${filterId})`).join(' '),\n      );\n    });\n  }\n}\n\nfunction convertToAbsoluteValue(param: CSSUnitValue) {\n  return param.unit === UnitType.kPercentage ? param.value / 100 : param.value;\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#blurEquivalent\n */\nfunction createBlur(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n  $feGaussianBlur.setAttribute('in', 'SourceGraphic');\n  $feGaussianBlur.setAttribute('stdDeviation', `${params[0].value}`);\n  $filter.appendChild($feGaussianBlur);\n}\n\nfunction createFeComponentTransfer(\n  document: Document,\n  $filter: SVGElement,\n  {\n    type,\n    slope,\n    intercept,\n    tableValues,\n  }: {\n    type: string;\n    slope?: number;\n    intercept?: number;\n    tableValues?: string;\n  },\n) {\n  const $feComponentTransfer = createSVGElement(\n    'feComponentTransfer',\n    document,\n  );\n  [\n    createSVGElement('feFuncR', document),\n    createSVGElement('feFuncG', document),\n    createSVGElement('feFuncB', document),\n  ].forEach(($feFunc) => {\n    $feFunc.setAttribute('type', type);\n\n    if (type === 'table') {\n      $feFunc.setAttribute('tableValues', `${tableValues}`);\n    } else {\n      $feFunc.setAttribute('slope', `${slope}`);\n      $feFunc.setAttribute('intercept', `${intercept}`);\n    }\n\n    $feComponentTransfer.appendChild($feFunc);\n  });\n\n  $filter.appendChild($feComponentTransfer);\n}\n\nfunction createContrast(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const slope = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'linear',\n    slope,\n    intercept: -(0.5 * slope) + 0.5,\n  });\n}\n\nfunction createInvert(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'table',\n    tableValues: `${amount} ${1 - amount}`,\n  });\n}\n\nfunction createBrightness(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const slope = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'linear',\n    slope,\n    intercept: 0,\n  });\n}\n\nfunction createSaturate(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'saturate');\n  $feColorMatrix.setAttribute('values', `${amount}`);\n  $filter.appendChild($feColorMatrix);\n}\n\nfunction createHueRotate(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'hueRotate');\n  // $feColorMatrix.setAttribute('values', `${params[0].to(UnitType.kDegrees).value}`);\n  // FIXME: convert to degrees\n  $feColorMatrix.setAttribute('values', `${params[0].value}`);\n  $filter.appendChild($feColorMatrix);\n}\n\nfunction createDropShadow(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const shadowOffsetX = params[0].value;\n  const shadowOffsetY = params[1].value;\n  const shadowBlur = params[2].value;\n  // @ts-ignore\n  const shadowColor = params[3].formatted as string;\n  const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n  $feGaussianBlur.setAttribute('in', 'SourceAlpha');\n  $feGaussianBlur.setAttribute('stdDeviation', `${shadowBlur}`);\n  $filter.appendChild($feGaussianBlur);\n\n  const $feOffset = createSVGElement('feOffset', document);\n  $feOffset.setAttribute('dx', `${shadowOffsetX}`);\n  $feOffset.setAttribute('dy', `${shadowOffsetY}`);\n  $feOffset.setAttribute('result', 'offsetblur');\n  $filter.appendChild($feOffset);\n\n  const $feFlood = createSVGElement('feFlood', document);\n  $feFlood.setAttribute('flood-color', shadowColor);\n  $filter.appendChild($feFlood);\n\n  const $feComposite = createSVGElement('feComposite', document);\n  $feComposite.setAttribute('in2', 'offsetblur');\n  $feComposite.setAttribute('operator', 'in');\n  $filter.appendChild($feComposite);\n\n  const $feMerge = createSVGElement('feMerge', document);\n  $filter.appendChild($feMerge);\n\n  const $feMergeNode1 = createSVGElement('feMergeNode', document);\n  const $feMergeNode2 = createSVGElement('feMergeNode', document);\n  $feMergeNode2.setAttribute('in', 'SourceGraphic');\n  $feMerge.appendChild($feMergeNode1);\n  $feMerge.appendChild($feMergeNode2);\n}\n\nfunction createFeColorMatrix(\n  document: Document,\n  $filter: SVGElement,\n  matrix: number[],\n) {\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'matrix');\n  $feColorMatrix.setAttribute('values', matrix.join(' '));\n  $filter.appendChild($feColorMatrix);\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#grayscaleEquivalent\n */\nfunction createGrayscale(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeColorMatrix(document, $filter, [\n    0.2126 + 0.7874 * (1 - amount),\n    0.7152 - 0.7152 * (1 - amount),\n    0.0722 - 0.0722 * (1 - amount),\n    0,\n    0,\n    0.2126 - 0.2126 * (1 - amount),\n    0.7152 + 0.2848 * (1 - amount),\n    0.0722 - 0.0722 * (1 - amount),\n    0,\n    0,\n    0.2126 - 0.2126 * (1 - amount),\n    0.7152 - 0.7152 * (1 - amount),\n    0.0722 + 0.9278 * (1 - amount),\n    0,\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n  ]);\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#sepiaEquivalent\n */\nfunction createSepia(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeColorMatrix(document, $filter, [\n    0.393 + 0.607 * (1 - amount),\n    0.769 - 0.769 * (1 - amount),\n    0.189 - 0.189 * (1 - amount),\n    0,\n    0,\n    0.349 - 0.349 * (1 - amount),\n    0.686 + 0.314 * (1 - amount),\n    0.168 - 0.168 * (1 - amount),\n    0,\n    0,\n    0.272 - 0.272 * (1 - amount),\n    0.534 - 0.534 * (1 - amount),\n    0.131 + 0.869 * (1 - amount),\n    0,\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n  ]);\n}\n","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nexport { _objectSpread2 as default };","import type { CSSRGB, Pattern, RadialGradient } from '@antv/g-lite';\nimport {\n  DisplayObject,\n  LinearGradient,\n  parseTransform,\n  computeLinearGradient,\n  computeRadialGradient,\n  CSSGradientValue,\n  GradientType,\n  Rect,\n  isBrowser,\n  isPattern,\n  isCSSRGB,\n  isCSSGradientValue,\n} from '@antv/g-lite';\nimport { isString } from '@antv/util';\nimport { SVGRendererPlugin } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { FILTER_PREFIX } from './Filter';\n\nexport const PATTERN_PREFIX = 'g-pattern-';\nlet cacheKey2IDMap: Record<string, string> = {};\nlet counter = 0;\n\nexport function resetPatternCounter() {\n  counter = 0;\n  cacheKey2IDMap = {};\n}\n\nexport function createOrUpdateGradientAndPattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  parsedColor: CSSGradientValue[] | CSSRGB | Pattern,\n  name: string,\n  createImage: () => HTMLImageElement,\n  plugin: SVGRendererPlugin,\n) {\n  // eg. clipPath don't have fill/stroke\n  if (!parsedColor) {\n    return '';\n  }\n\n  if (isCSSRGB(parsedColor)) {\n    // keep using currentColor @see https://github.com/d3/d3-axis/issues/49\n    if (object.style[name] === 'currentColor') {\n      $el?.setAttribute(name, 'currentColor');\n    } else {\n      // constant value, eg. '#fff'\n      $el?.setAttribute(\n        name,\n        parsedColor.isNone ? 'none' : parsedColor.toString(),\n      );\n    }\n  } else if (isPattern(parsedColor)) {\n    const patternId = createOrUpdatePattern(\n      document,\n      $def,\n      object,\n      parsedColor,\n      createImage,\n      plugin,\n    );\n    // use style instead of attribute when applying <pattern>\n    // @see https://stackoverflow.com/a/7723115\n    $el.style[name] = `url(#${patternId})`;\n    return patternId;\n  } else {\n    if (parsedColor.length === 1) {\n      const gradientId = createOrUpdateGradient(\n        document,\n        object,\n        $def,\n        $el,\n        parsedColor[0],\n      );\n      $el?.setAttribute(name, `url(#${gradientId})`);\n      return gradientId;\n    }\n    // @see https://stackoverflow.com/questions/20671502/can-i-blend-gradients-in-svg\n    const filterId = createOrUpdateMultiGradient(\n      document,\n      object,\n      $def,\n      $el,\n      parsedColor,\n    );\n    $el?.setAttribute('filter', `url(#${filterId})`);\n    $el?.setAttribute('fill', 'black');\n    return filterId;\n  }\n\n  return '';\n}\n\nfunction generateCacheKey(\n  src: CSSGradientValue | CSSRGB | Pattern,\n  options: any = {},\n): string {\n  let cacheKey = '';\n  if (isCSSGradientValue(src)) {\n    const { type, value } = src;\n    if (\n      type === GradientType.LinearGradient ||\n      type === GradientType.RadialGradient\n    ) {\n      // @ts-ignore\n      const { type, x, y, width, height, steps, angle, cx, cy, size } = {\n        ...value,\n        ...options,\n      };\n      cacheKey = `gradient-${type}-${x?.toString() || 0}-${\n        y?.toString() || 0\n      }-${angle?.toString() || 0}-${cx?.toString() || 0}-${\n        cy?.toString() || 0\n      }-${size?.toString() || 0}-${width}-${height}-${steps\n        .map(({ offset, color }) => `${offset}${color}`)\n        .join('-')}`;\n    }\n  } else if (isPattern(src)) {\n    if (isString(src.image)) {\n      cacheKey = `pattern-${src.image}-${src.repetition}`;\n    } else if ((src.image as Rect).nodeName === 'rect') {\n      // use rect's entity as key\n      cacheKey = `pattern-rect-${(src.image as Rect).entity}`;\n    } else {\n      cacheKey = `pattern-${counter}`;\n    }\n  }\n\n  if (cacheKey) {\n    if (!cacheKey2IDMap[cacheKey]) {\n      cacheKey2IDMap[cacheKey] = `${PATTERN_PREFIX}${counter++}`;\n    }\n  }\n\n  return cacheKey2IDMap[cacheKey];\n}\n\nfunction formatTransform(transform: string) {\n  // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/patternTransform\n  // should remove unit: rotate(20deg) -> rotate(20)\n  return parseTransform(transform)\n    .map((parsed) => {\n      const { t, d } = parsed;\n      if (t === 'translate') {\n        return `translate(${d[0].value} ${d[1].value})`;\n      }\n      if (t === 'translateX') {\n        return `translate(${d[0].value} 0)`;\n      }\n      if (t === 'translateY') {\n        return `translate(0 ${d[0].value})`;\n      }\n      if (t === 'rotate') {\n        return `rotate(${d[0].value})`;\n      }\n      if (t === 'scale') {\n        // scale(1) scale(1, 1)\n        const newScale = d?.map((s) => s.value) || [1, 1];\n        return `scale(${newScale[0]}, ${newScale[1]})`;\n      }\n      if (t === 'scaleX') {\n        const newScale = d?.map((s) => s.value) || [1];\n        return `scale(${newScale[0]}, 1)`;\n      }\n      if (t === 'scaleY') {\n        const newScale = d?.map((s) => s.value) || [1];\n        return `scale(1, ${newScale[0]})`;\n      }\n      if (t === 'skew') {\n        const newSkew = d?.map((s) => s.value) || [0, 0];\n        return `skewX(${newSkew[0]}) skewY(${newSkew[1]})`;\n      }\n      if (t === 'skewZ') {\n        const newSkew = d?.map((s) => s.value) || [0];\n        return `skewX(${newSkew[0]})`;\n      }\n      if (t === 'skewY') {\n        const newSkew = d?.map((s) => s.value) || [0];\n        return `skewY(${newSkew[0]})`;\n      }\n      if (t === 'matrix') {\n        const [a, b, c, dd, tx, ty] = d.map((s) => s.value);\n        return `matrix(${a} ${b} ${c} ${dd} ${tx} ${ty})`;\n      }\n\n      return null;\n    })\n    .filter((item) => item !== null)\n    .join(' ');\n}\n\nfunction create$Pattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  pattern: Pattern,\n  patternId: string,\n  width: number,\n  height: number,\n) {\n  const { repetition, transform } = pattern;\n\n  // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/pattern\n  const $pattern = createSVGElement('pattern', document) as SVGPatternElement;\n  if (transform) {\n    $pattern.setAttribute('patternTransform', formatTransform(transform));\n  }\n  $pattern.setAttribute('patternUnits', 'userSpaceOnUse');\n\n  $pattern.id = patternId;\n  $def.appendChild($pattern);\n\n  const { halfExtents, min } = object.getGeometryBounds();\n  $pattern.setAttribute('x', `${min[0]}`);\n  $pattern.setAttribute('y', `${min[1]}`);\n\n  // There is no equivalent to CSS no-repeat for SVG patterns\n  // @see https://stackoverflow.com/a/33481956\n  let patternWidth = width;\n  let patternHeight = height;\n  if (repetition === 'repeat-x') {\n    patternHeight = halfExtents[1] * 2;\n  } else if (repetition === 'repeat-y') {\n    patternWidth = halfExtents[0] * 2;\n  } else if (repetition === 'no-repeat') {\n    patternWidth = halfExtents[0] * 2;\n    patternHeight = halfExtents[1] * 2;\n  }\n  $pattern.setAttribute('width', `${patternWidth}`);\n  $pattern.setAttribute('height', `${patternHeight}`);\n\n  return $pattern;\n}\n\nfunction createOrUpdatePattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  pattern: Pattern,\n  createImage: () => HTMLImageElement,\n  plugin: SVGRendererPlugin,\n) {\n  const patternId = generateCacheKey(pattern);\n  const $existed = $def.querySelector(`#${patternId}`);\n  if (!$existed) {\n    const { image } = pattern;\n\n    let imageURL = '';\n    if (isString(image)) {\n      imageURL = image;\n    } else if (isBrowser) {\n      if (image instanceof HTMLImageElement) {\n        imageURL = image.src;\n      } else if (image instanceof HTMLCanvasElement) {\n        imageURL = image.toDataURL();\n      } else if (image instanceof HTMLVideoElement) {\n        // won't support\n      }\n    }\n\n    if (imageURL) {\n      const $image = createSVGElement('image', document);\n      // use href instead of xlink:href\n      // @see https://stackoverflow.com/a/13379007\n      $image.setAttribute('href', imageURL);\n\n      const img = createImage();\n\n      if (!imageURL.match(/^data:/i)) {\n        img.crossOrigin = 'Anonymous';\n        $image.setAttribute('crossorigin', 'anonymous');\n      }\n      img.src = imageURL;\n      const onload = function () {\n        const $pattern = create$Pattern(\n          document,\n          $def,\n          object,\n          pattern,\n          patternId,\n          img.width,\n          img.height,\n        );\n\n        $def.appendChild($pattern);\n        $pattern.appendChild($image);\n\n        $image.setAttribute('x', '0');\n        $image.setAttribute('y', '0');\n        $image.setAttribute('width', `${img.width}`);\n        $image.setAttribute('height', `${img.height}`);\n      };\n      if (img.complete) {\n        onload();\n      } else {\n        img.onload = onload;\n        // Fix onload() bug in IE9\n        // img.src = img.src;\n      }\n    }\n\n    if ((image as Rect).nodeName === 'rect') {\n      const { width, height } = (image as Rect).parsedStyle;\n\n      const $pattern = create$Pattern(\n        document,\n        $def,\n        image as Rect,\n        pattern,\n        patternId,\n        width,\n        height,\n      );\n\n      // traverse subtree of pattern\n      (image as Rect).forEach((object: DisplayObject) => {\n        plugin.createSVGDom(document, object, null);\n\n        // @ts-ignore\n        const svgElement = object.elementSVG;\n\n        // apply local RTS transformation to <group> wrapper\n        const localTransform = object.getLocalTransform();\n        plugin.applyTransform(svgElement.$groupEl, localTransform);\n      });\n\n      // @ts-ignore\n      const svgElement = image.elementSVG;\n      $pattern.appendChild(svgElement.$groupEl);\n    }\n  }\n  return patternId;\n}\n\nfunction createOrUpdateGradient(\n  document: Document,\n  object: DisplayObject,\n  $def: SVGDefsElement,\n  $el: SVGElement,\n  parsedColor: CSSGradientValue,\n) {\n  const bounds = object.getGeometryBounds();\n  const width = (bounds && bounds.halfExtents[0] * 2) || 0;\n  const height = (bounds && bounds.halfExtents[1] * 2) || 0;\n  const min = (bounds && bounds.min) || [0, 0];\n\n  const gradientId = generateCacheKey(parsedColor, {\n    x: min[0],\n    y: min[1],\n    width,\n    height,\n  });\n  let $existed = $def.querySelector(`#${gradientId}`);\n\n  if (!$existed) {\n    // <linearGradient> <radialGradient>\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/linearGradient\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/radialGradient\n    $existed = createSVGElement(\n      parsedColor.type === GradientType.LinearGradient\n        ? 'linearGradient'\n        : 'radialGradient',\n      document,\n    );\n    // @see https://github.com/antvis/g/issues/1025\n    $existed.setAttribute('gradientUnits', 'userSpaceOnUse');\n    // add stops\n    let innerHTML = '';\n    (parsedColor.value as LinearGradient).steps\n      // sort by offset @see https://github.com/antvis/G/issues/1171\n      .sort((a, b) => a.offset.value - b.offset.value)\n      .forEach(({ offset, color }) => {\n        // TODO: support absolute unit like `px`\n        innerHTML += `<stop offset=\"${\n          offset.value / 100\n        }\" stop-color=\"${color}\"></stop>`;\n      });\n    $existed.innerHTML = innerHTML;\n    $existed.id = gradientId;\n    $def.appendChild($existed);\n  }\n\n  if (parsedColor.type === GradientType.LinearGradient) {\n    const { angle } = parsedColor.value as LinearGradient;\n    const { x1, y1, x2, y2 } = computeLinearGradient(\n      [min[0], min[1]],\n      width,\n      height,\n      angle,\n    );\n\n    $existed.setAttribute('x1', `${x1}`);\n    $existed.setAttribute('y1', `${y1}`);\n    $existed.setAttribute('x2', `${x2}`);\n    $existed.setAttribute('y2', `${y2}`);\n\n    // $existed.setAttribute('gradientTransform', `rotate(${angle})`);\n  } else {\n    const { cx, cy, size } = parsedColor.value as RadialGradient;\n    const { x, y, r } = computeRadialGradient(\n      [min[0], min[1]],\n      width,\n      height,\n      cx,\n      cy,\n      size,\n    );\n\n    $existed.setAttribute('cx', `${x}`);\n    $existed.setAttribute('cy', `${y}`);\n    $existed.setAttribute('r', `${r}`);\n  }\n\n  return gradientId;\n}\n\nfunction createOrUpdateMultiGradient(\n  document: Document,\n  object: DisplayObject,\n  $def: SVGDefsElement,\n  $el: SVGElement,\n  gradients: CSSGradientValue[],\n) {\n  const filterId = `${FILTER_PREFIX + object.entity}-gradient`;\n  let $existed = $def.querySelector(`#${filterId}`);\n  if (!$existed) {\n    $existed = createSVGElement('filter', document) as SVGFilterElement;\n    $existed.setAttribute('filterUnits', 'userSpaceOnUse');\n    // @see https://github.com/antvis/g/issues/1025\n    $existed.setAttribute('x', '0%');\n    $existed.setAttribute('y', '0%');\n    $existed.setAttribute('width', '100%');\n    $existed.setAttribute('height', '100%');\n\n    $existed.id = filterId;\n\n    $def.appendChild($existed);\n  }\n\n  /**\n   * <rect id=\"wave-rect\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"url(#wave)\"></rect>\n   * <filter id=\"blend-it\" x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\">\n        <feImage xlink:href=\"#wave-rect\" result=\"myWave\" x=\"100\" y=\"100\"/>\n        <feImage xlink:href=\"#ry-rect\" result=\"myRY\"  x=\"100\" y=\"100\"/>\n        <feBlend in=\"myWave\" in2=\"myRY\" mode=\"multiply\" result=\"blendedGrad\"/>\n        <feComposite in=\"blendedGrad\" in2=\"SourceGraphic\" operator=\"in\"/>\n    </filter>\n   */\n\n  let blended = 0;\n  gradients.forEach((gradient, i) => {\n    const gradientId = createOrUpdateGradient(\n      document,\n      object,\n      $def,\n      $el,\n      gradient,\n    );\n\n    const rectId = `${gradientId}_rect`;\n    const $rect = createSVGElement('rect', document) as SVGRectElement;\n    $rect.setAttribute('x', '0');\n    $rect.setAttribute('y', '0');\n    $rect.setAttribute('width', '100%');\n    $rect.setAttribute('height', '100%');\n    $rect.setAttribute('fill', `url(#${gradientId})`);\n    $rect.id = rectId;\n    $def.appendChild($rect);\n\n    const $feImage = createSVGElement('feImage', document) as SVGFEImageElement;\n    $feImage.setAttribute('href', `#${rectId}`);\n    $feImage.setAttribute('result', `${filterId}-${i}`);\n    $existed.appendChild($feImage);\n\n    if (i > 0) {\n      const $feBlend = createSVGElement(\n        'feBlend',\n        document,\n      ) as SVGFEBlendElement;\n      $feBlend.setAttribute(\n        'in',\n        i === 1 ? `${filterId}-${i - 1}` : `${filterId}-blended-${blended - 1}`,\n      );\n      $feBlend.setAttribute('in2', `${filterId}-${i}`);\n      $feBlend.setAttribute('result', `${filterId}-blended-${blended++}`);\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/blend-mode\n      $feBlend.setAttribute('mode', 'multiply');\n      $existed.appendChild($feBlend);\n    }\n  });\n\n  const $feComposite = createSVGElement(\n    'feComposite',\n    document,\n  ) as SVGFECompositeElement;\n  $feComposite.setAttribute('in', `${filterId}-blended-${blended}`);\n  $feComposite.setAttribute('in2', 'SourceGraphic');\n  $feComposite.setAttribute('operator', 'in');\n  $existed.appendChild($feComposite);\n\n  return filterId;\n}\n","import {\n  CanvasContext,\n  CSSGradientValue,\n  CSSRGB,\n  DisplayObject,\n  ParsedBaseStyleProps,\n  Pattern,\n  ContextService,\n  isPattern,\n} from '@antv/g-lite';\nimport { SVGRendererPlugin } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { createOrUpdateFilter } from './Filter';\nimport { createOrUpdateGradientAndPattern } from './Pattern';\nimport { createOrUpdateShadow } from './Shadow';\n\nconst urlRegexp = /url\\(\"?#(.*)\\)/;\n\nexport class DefElementManager {\n  constructor(private context: CanvasContext) {}\n\n  /**\n   * container for <gradient> <clipPath>...\n   */\n  private $def: SVGDefsElement;\n\n  private gradientCache: Record<string, Set<number>> = {};\n\n  getDefElement() {\n    return this.$def;\n  }\n\n  init() {\n    const { document } = this.context.config;\n    const $svg = (\n      this.context.contextService as ContextService<SVGElement>\n    ).getContext();\n    this.$def = createSVGElement('defs', document) as SVGDefsElement;\n    $svg.appendChild(this.$def);\n  }\n\n  clear(entity: number) {\n    Object.keys(this.gradientCache).forEach((id) => {\n      this.clearUnusedDefElement(this.gradientCache, id, entity);\n    });\n  }\n\n  private clearUnusedDefElement(\n    cache: Record<string, Set<number>>,\n    id: string,\n    entity: number,\n  ) {\n    if (cache[id] && cache[id].size === 1 && cache[id].has(entity)) {\n      const targetElement = this.$def.querySelector(`#${id}`);\n      if (targetElement) {\n        this.$def.removeChild(targetElement);\n      }\n    }\n  }\n\n  createOrUpdateGradientAndPattern(\n    object: DisplayObject,\n    $el: SVGElement,\n    parsedColor: CSSGradientValue[] | CSSRGB | Pattern,\n    name: string,\n    plugin: SVGRendererPlugin,\n  ) {\n    const { document: doc, createImage } = this.context.config;\n\n    if ($el) {\n      let attributeValue = '';\n      if (isPattern(parsedColor)) {\n        // `fill: url(#${patternId})`\n        attributeValue = $el.style[name];\n      } else {\n        // `url(#${gradientId})`\n        attributeValue = $el.getAttribute(name) || '';\n      }\n\n      const matches = attributeValue.match(urlRegexp);\n      if (matches && matches.length > 1) {\n        this.clearUnusedDefElement(\n          this.gradientCache,\n          matches[1].replace('\"', ''),\n          object.entity,\n        );\n      }\n\n      const newDefElementId = createOrUpdateGradientAndPattern(\n        doc || document,\n        this.$def,\n        object,\n        $el,\n        parsedColor,\n        name,\n        createImage,\n        plugin,\n      );\n      if (newDefElementId) {\n        if (!this.gradientCache[newDefElementId]) {\n          this.gradientCache[newDefElementId] = new Set();\n        }\n        this.gradientCache[newDefElementId].add(object.entity);\n      }\n    }\n  }\n\n  createOrUpdateShadow(object: DisplayObject, $el: SVGElement, name: string) {\n    const { document: doc } = this.context.config;\n    createOrUpdateShadow(doc || document, this.$def, object, $el, name);\n  }\n\n  createOrUpdateFilter(\n    object: DisplayObject,\n    $el: SVGElement,\n    filters: ParsedBaseStyleProps['filter'],\n  ) {\n    const { document: doc } = this.context.config;\n    createOrUpdateFilter(doc || document, this.$def, object, $el, filters);\n  }\n}\n","import type { DisplayObject } from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { createSVGElement } from '../../utils/dom';\n\nconst FILTER_DROPSHADOW_PREFIX = 'g-filter-dropshadow-';\n\n/**\n * use SVG filters\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/filter\n */\nexport function createOrUpdateShadow(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  name: string,\n) {\n  const {\n    shadowType = 'outer',\n    shadowBlur,\n    shadowColor,\n    shadowOffsetX,\n    shadowOffsetY,\n  } = object.parsedStyle;\n\n  const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n  const shadowId = FILTER_DROPSHADOW_PREFIX + object.entity;\n  let $existedFilter = $def.querySelector(`#${shadowId}`);\n  if ($existedFilter) {\n    const existedShadowType = $existedFilter.getAttribute('data-type');\n    if (existedShadowType !== shadowType || !hasShadow) {\n      // remove existed shadow\n      $existedFilter.remove();\n      $existedFilter = null;\n    }\n  }\n\n  // <Group> also has shadowType as its default value\n  // only apply shadow when blur > 0\n  if (hasShadow) {\n    // use filter <feDropShadow>\n    // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/feDropShadow\n    $el?.setAttribute('filter', `url(#${shadowId})`);\n  } else {\n    $el?.removeAttribute('filter');\n    return;\n  }\n\n  if (!$existedFilter) {\n    $existedFilter = createSVGElement('filter', document) as SVGFilterElement;\n    $existedFilter.setAttribute('data-type', shadowType);\n\n    if (shadowType === 'outer') {\n      const $feDropShadow = createSVGElement('feDropShadow', document);\n      $feDropShadow.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n      $feDropShadow.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n      $feDropShadow.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n      $feDropShadow.setAttribute('flood-color', shadowColor.toString());\n      $existedFilter.appendChild($feDropShadow);\n    } else if (shadowType === 'inner') {\n      const $feComponentTransfer = createSVGElement(\n        'feComponentTransfer',\n        document,\n      );\n      $feComponentTransfer.setAttribute('in', 'SourceAlpha');\n      const $feFuncA = createSVGElement('feFuncA', document);\n      $feFuncA.setAttribute('type', 'table');\n      $feFuncA.setAttribute('tableValues', '1 0');\n      $feComponentTransfer.appendChild($feFuncA);\n      $existedFilter.appendChild($feComponentTransfer);\n\n      const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n      $feGaussianBlur.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n      $existedFilter.appendChild($feGaussianBlur);\n\n      const $feOffset = createSVGElement('feOffset', document);\n      $feOffset.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n      $feOffset.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n      $feOffset.setAttribute('result', 'offsetblur');\n      $existedFilter.appendChild($feOffset);\n\n      const $feFlood = createSVGElement('feFlood', document);\n      $feFlood.setAttribute('flood-color', shadowColor.toString());\n      $feFlood.setAttribute('result', 'color');\n      $existedFilter.appendChild($feFlood);\n\n      const $feComposite = createSVGElement('feComposite', document);\n      $feComposite.setAttribute('in2', 'offsetblur');\n      $feComposite.setAttribute('operator', 'in');\n      $existedFilter.appendChild($feComposite);\n\n      const $feComposite2 = createSVGElement('feComposite', document);\n      $feComposite2.setAttribute('in2', 'SourceAlpha');\n      $feComposite2.setAttribute('operator', 'in');\n      $existedFilter.appendChild($feComposite2);\n\n      const $feMerge = createSVGElement('feMerge', document);\n      $existedFilter.appendChild($feMerge);\n      const $feMergeNode = createSVGElement('feMergeNode', document);\n      $feMergeNode.setAttribute('in', 'SourceGraphic');\n      const $feMergeNode2 = createSVGElement('feMergeNode', document);\n      $feMerge.appendChild($feMergeNode);\n      $feMerge.appendChild($feMergeNode2);\n    }\n\n    $existedFilter.id = shadowId;\n    // @see https://github.com/antvis/g/issues/1025\n    $existedFilter.setAttribute('filterUnits', 'userSpaceOnUse');\n    $def.appendChild($existedFilter);\n    return;\n  }\n\n  if (shadowType === 'inner') {\n    const $feGaussianBlur = $existedFilter\n      .children[1] as SVGFEGaussianBlurElement;\n    const $feOffset = $existedFilter.children[2] as SVGFEOffsetElement;\n    const $feFlood = $existedFilter.children[3] as SVGFEFloodElement;\n    if (name === 'shadowColor') {\n      $feFlood.setAttribute('flood-color', shadowColor.toString());\n    } else if (name === 'shadowBlur') {\n      // half the blur radius\n      // @see https://drafts.csswg.org/css-backgrounds/#shadow-blur\n      // @see https://css-tricks.com/breaking-css-box-shadow-vs-drop-shadow/\n      $feGaussianBlur.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n    } else if (name === 'shadowOffsetX') {\n      $feOffset.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n    } else if (name === 'shadowOffsetY') {\n      $feOffset.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n    }\n  } else if (shadowType === 'outer') {\n    const $feDropShadow = $existedFilter.children[0] as SVGPatternElement;\n    if (name === 'shadowColor') {\n      $feDropShadow.setAttribute('flood-color', shadowColor.toString());\n    } else if (name === 'shadowBlur') {\n      // half the blur radius\n      // @see https://drafts.csswg.org/css-backgrounds/#shadow-blur\n      // @see https://css-tricks.com/breaking-css-box-shadow-vs-drop-shadow/\n      $feDropShadow.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n    } else if (name === 'shadowOffsetX') {\n      $feDropShadow.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n    } else if (name === 'shadowOffsetY') {\n      $feDropShadow.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n    }\n  }\n}\n","export function numberToLongString(x: number) {\n  return x.toFixed(6).replace('.000000', '');\n}\n\nexport function convertHTML(str: string) {\n  const regex = /[&|<|>|\"|']/g;\n  return str.replace(regex, function (match) {\n    if (match === '&') {\n      return '&amp;';\n    }\n    if (match === '<') {\n      return '&lt;';\n    }\n    if (match === '>') {\n      return '&gt;';\n    }\n    if (match === '\"') {\n      return '&quot;';\n    }\n    return '&apos;';\n  });\n}\n","import {\n  DisplayObject,\n  FederatedEvent,\n  CustomEvent,\n  LinearGradient,\n  MutationEvent,\n  MutationRecord,\n  RadialGradient,\n  RenderingPlugin,\n  RenderingPluginContext,\n  ContextService,\n  ElementEvent,\n  propertyMetadataCache,\n  RenderReason,\n  Shape,\n  isCSSRGB,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\nimport { ElementSVG } from './components/ElementSVG';\nimport { resetPatternCounter, type DefElementManager } from './shapes/defs';\nimport type { SVGRendererPluginOptions } from './interfaces';\nimport { createSVGElement } from './utils/dom';\nimport { numberToLongString } from './utils/format';\n\nexport const SVG_ATTR_MAP: Record<string, string> = {\n  opacity: 'opacity',\n  fillStyle: 'fill',\n  fill: 'fill',\n  fillRule: 'fill-rule',\n  fillOpacity: 'fill-opacity',\n  strokeStyle: 'stroke',\n  strokeOpacity: 'stroke-opacity',\n  stroke: 'stroke',\n  clipPath: 'clip-path',\n  textPath: 'text-path',\n  r: 'r',\n  cx: 'cx',\n  cy: 'cy',\n  rx: 'rx',\n  ry: 'ry',\n  x: 'x',\n  y: 'y',\n  width: 'width',\n  height: 'height',\n  lineCap: 'stroke-linecap',\n  lineJoin: 'stroke-linejoin',\n  lineWidth: 'stroke-width',\n  lineDash: 'stroke-dasharray',\n  lineDashOffset: 'stroke-dashoffset',\n  miterLimit: 'stroke-miterlimit',\n  font: 'font',\n  fontSize: 'font-size',\n  fontStyle: 'font-style',\n  fontVariant: 'font-variant',\n  fontWeight: 'font-weight',\n  fontFamily: 'font-family',\n  letterSpacing: 'letter-spacing',\n  startArrow: 'marker-start',\n  endArrow: 'marker-end',\n  class: 'class',\n  id: 'id',\n  // style: 'style',\n  preserveAspectRatio: 'preserveAspectRatio',\n  visibility: 'visibility',\n  shadowColor: 'flood-color',\n  shadowBlur: 'stdDeviation',\n  shadowOffsetX: 'dx',\n  shadowOffsetY: 'dy',\n  filter: 'filter',\n  innerHTML: 'innerHTML',\n  textAlign: 'text-anchor',\n  pointerEvents: 'pointer-events',\n};\n\nconst FORMAT_VALUE_MAP = {\n  textAlign: {\n    inherit: 'inherit',\n    left: 'left',\n    start: 'left',\n    center: 'middle',\n    right: 'end',\n    end: 'end',\n  },\n};\n\nexport const DEFAULT_VALUE_MAP: Record<string, string> = {\n  textAlign: 'inherit',\n  // textBaseline: 'alphabetic',\n  // @see https://www.w3.org/TR/SVG/painting.html#LineCaps\n  lineCap: 'butt',\n  // @see https://www.w3.org/TR/SVG/painting.html#LineJoin\n  lineJoin: 'miter',\n  // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/stroke-width\n  lineWidth: '1px',\n  opacity: '1',\n  fillOpacity: '1',\n  fillRule: 'nonzero',\n  strokeOpacity: '1',\n  strokeWidth: '0',\n  strokeMiterLimit: '4',\n  letterSpacing: '0',\n  fontSize: 'inherit',\n  fontFamily: 'inherit',\n  pointerEvents: 'auto',\n  transform: 'matrix(1,0,0,1,0,0)',\n};\n\nexport type GradientParams = LinearGradient | RadialGradient;\n\n/**\n * G_SVG_PREFIX + nodeName + entity\n *\n * eg. g_svg_circle_345\n */\nexport const G_SVG_PREFIX = 'g-svg';\nexport const CLIP_PATH_PREFIX = 'clip-path-';\nexport const TEXT_PATH_PREFIX = 'text-path-';\n\nexport class SVGRendererPlugin implements RenderingPlugin {\n  static tag = 'SVGRenderer';\n\n  constructor(\n    private pluginOptions: SVGRendererPluginOptions,\n    private defElementManager: DefElementManager,\n    private context: RenderingPluginContext,\n  ) {}\n\n  /**\n   * Will be used in g-plugin-svg-picker for finding relative SVG element of current DisplayObject.\n   */\n  private svgElementMap: WeakMap<SVGElement, DisplayObject> = new WeakMap();\n\n  /**\n   * <camera>\n   */\n  private $camera: SVGElement;\n\n  /**\n   * render at the end of frame\n   */\n  private renderQueue: DisplayObject[] = [];\n\n  /**\n   * dirty attributes at the end of frame\n   */\n  private dirtyAttributes: WeakMap<DisplayObject, string[]> = new WeakMap();\n\n  /**\n   * reorder after mounted\n   */\n  private pendingReorderQueue: Set<DisplayObject> = new Set();\n\n  /**\n   * <use> elements in <clipPath>, which should be sync with clipPath\n   *\n   * @example\n   * <clipPath transform=\"matrix(1,0,0,1,-100,-155)\" id=\"clip-path-0-2\">\n   *  <use href=\"#g_svg_circle_0\" transform=\"matrix(1.477115,0,0,1.477115,150,150)\">\n   *  </use>\n   * </clipPath>\n   */\n  private clipPathUseMap: WeakMap<DisplayObject, SVGUseElement[]> =\n    new WeakMap();\n\n  apply(context: RenderingPluginContext) {\n    const { renderingService, renderingContext } = context;\n    this.context = context;\n    // @ts-ignore\n    this.context.svgElementMap = this.svgElementMap;\n    const canvas = renderingContext.root.ownerDocument.defaultView;\n\n    const { document } = this.context.config;\n\n    const handleMounted = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n\n      // should remove clipPath already existed in <defs>\n      const $useRefs = this.clipPathUseMap.get(object);\n      if ($useRefs) {\n        const $def = this.defElementManager.getDefElement();\n        const existed = $def.querySelector(`#${this.getId(object)}`);\n        if (existed) {\n          existed.remove();\n        }\n      }\n\n      // create SVG DOM Node\n      this.createSVGDom(document, object, this.$camera);\n    };\n\n    const handleUnmounted = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n      this.defElementManager.clear(object.entity);\n      this.clipPathUseMap.delete(object);\n      this.removeSVGDom(object);\n    };\n\n    const reorderChildren = (object: DisplayObject) => {\n      const parent = object.parentNode;\n      // @ts-ignore\n      const $groupEl = object.parentNode?.elementSVG?.$groupEl;\n      const children = (parent?.children || []).slice();\n\n      if ($groupEl) {\n        this.reorderChildren(document, $groupEl, children as DisplayObject[]);\n      }\n    };\n\n    const handleReparent = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n      reorderChildren(object);\n    };\n\n    const handleAttributeChanged = (e: MutationEvent) => {\n      const object = e.target as DisplayObject;\n\n      // @see https://github.com/antvis/g/issues/994\n      // @ts-ignore\n      if (!object.elementSVG) {\n        return;\n      }\n\n      const { attrName } = e;\n\n      let attribtues = this.dirtyAttributes.get(object);\n      if (!attribtues) {\n        this.dirtyAttributes.set(object, []);\n        attribtues = this.dirtyAttributes.get(object);\n      }\n\n      attribtues.push(attrName);\n    };\n\n    const handleGeometryBoundsChanged = (\n      e: CustomEvent<{ detail: MutationRecord[] }>,\n    ) => {\n      const records = e.detail;\n      for (let i = 0; i < records.length; i++) {\n        const record = records[i];\n        const object = record.target as DisplayObject;\n        const nodes =\n          object.nodeName === Shape.FRAGMENT ? object.childNodes : [object];\n\n        nodes.forEach((node: DisplayObject) => {\n          // @ts-ignore\n          const $el = object.elementSVG?.$el;\n\n          const { fill, stroke, clipPath } = object.parsedStyle;\n\n          if (fill && !isCSSRGB(fill)) {\n            this.defElementManager.createOrUpdateGradientAndPattern(\n              object,\n              $el,\n              fill,\n              'fill',\n              this,\n            );\n          }\n          if (stroke && !isCSSRGB(stroke)) {\n            this.defElementManager.createOrUpdateGradientAndPattern(\n              object,\n              $el,\n              stroke,\n              'stroke',\n              this,\n            );\n          }\n          if (clipPath) {\n            const parentInvert = mat4.invert(\n              mat4.create(),\n              object.getWorldTransform(),\n            );\n\n            const clipPathId = `${CLIP_PATH_PREFIX + clipPath.entity}-${object.entity}`;\n            const $def = this.defElementManager.getDefElement();\n            const $existed = $def.querySelector<SVGElement>(`#${clipPathId}`);\n            if ($existed) {\n              this.applyTransform($existed, parentInvert);\n            }\n          }\n        });\n      }\n    };\n\n    renderingService.hooks.init.tap(SVGRendererPlugin.tag, () => {\n      const { background, document } = this.context.config;\n\n      // <defs>\n      this.defElementManager.init();\n\n      const $svg = (\n        this.context.contextService as ContextService<SVGElement>\n      ).getContext();\n      if (background) {\n        $svg.style.background = background;\n      }\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/color-interpolation-filters\n      $svg.setAttribute('color-interpolation-filters', 'sRGB');\n\n      this.$camera = createSVGElement('g', document);\n      this.$camera.id = `${G_SVG_PREFIX}-camera`;\n      this.applyTransform(this.$camera, this.context.camera.getOrthoMatrix());\n      $svg.appendChild(this.$camera);\n\n      canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n      canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n      canvas.addEventListener(ElementEvent.REPARENT, handleReparent);\n      canvas.addEventListener(\n        ElementEvent.ATTR_MODIFIED,\n        handleAttributeChanged,\n      );\n      canvas.addEventListener(\n        ElementEvent.BOUNDS_CHANGED,\n        handleGeometryBoundsChanged,\n      );\n    });\n\n    renderingService.hooks.destroy.tap(SVGRendererPlugin.tag, () => {\n      canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n      canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n      canvas.removeEventListener(ElementEvent.REPARENT, handleReparent);\n      canvas.removeEventListener(\n        ElementEvent.ATTR_MODIFIED,\n        handleAttributeChanged,\n      );\n      canvas.removeEventListener(\n        ElementEvent.BOUNDS_CHANGED,\n        handleGeometryBoundsChanged,\n      );\n      resetPatternCounter();\n    });\n\n    renderingService.hooks.render.tap(\n      SVGRendererPlugin.tag,\n      (object: DisplayObject) => {\n        this.renderQueue.push(object);\n      },\n    );\n\n    renderingService.hooks.beginFrame.tap(SVGRendererPlugin.tag, () => {\n      const { document: doc } = this.context.config;\n\n      if (this.pendingReorderQueue.size) {\n        this.pendingReorderQueue.forEach((object) => {\n          const children = (object?.children || []).slice() as DisplayObject[];\n          const $parentGroupEl =\n            // @ts-ignore\n            object?.elementSVG?.$groupEl;\n\n          if ($parentGroupEl) {\n            this.reorderChildren(\n              doc || document,\n              $parentGroupEl,\n              children || [],\n            );\n          }\n        });\n        this.pendingReorderQueue.clear();\n      }\n    });\n\n    renderingService.hooks.endFrame.tap(SVGRendererPlugin.tag, () => {\n      if (renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED)) {\n        this.applyTransform(this.$camera, this.context.camera.getOrthoMatrix());\n      }\n\n      this.renderQueue.forEach((object) => {\n        const $el = ((object as any).elementSVG as ElementSVG)?.$el;\n        const $groupEl = ((object as any).elementSVG as ElementSVG)?.$groupEl;\n\n        if ($el && $groupEl) {\n          // apply local RTS transformation to <group> wrapper\n          // account for anchor\n          const localTransform = object.getLocalTransform();\n          this.applyTransform($groupEl, localTransform);\n\n          // clipped shapes should also be informed\n\n          const $useRefs = this.clipPathUseMap.get(object);\n          if ($useRefs && $useRefs.length) {\n            $useRefs.forEach(($use) => {\n              // <clipPath transform=\"matrix()\"><circle /></clipPath>\n              this.applyTransform($use, object.getWorldTransform());\n              // const parentInvert = mat4.invert(\n              //   mat4.create(),\n              //   (object as DisplayObject).getWorldTransform(),\n              // );\n              // this.applyTransform($clipPath, parentInvert);\n            });\n          }\n\n          // finish rendering, clear dirty flag\n          object.renderable.dirty = false;\n        }\n\n        // update dirty attributes\n        const attributes = this.dirtyAttributes.get(object);\n        if (attributes) {\n          attributes.forEach((attrName) => {\n            if (attrName === 'zIndex') {\n              reorderChildren(object);\n            } else if (attrName === 'increasedLineWidthForHitTesting') {\n              this.createOrUpdateHitArea(object, $el, $groupEl);\n            }\n\n            this.updateAttribute(object, [attrName]);\n          });\n\n          this.dirtyAttributes.delete(object);\n        }\n      });\n      this.renderQueue = [];\n    });\n  }\n\n  private getId(object: DisplayObject) {\n    return object.id || `${G_SVG_PREFIX}-${object.entity}`;\n  }\n\n  private reorderChildren(\n    doc: Document,\n    $groupEl: SVGElement,\n    children: DisplayObject[],\n  ) {\n    // need to reorder parent's children\n    children.sort((a, b) => a.sortable.renderOrder - b.sortable.renderOrder);\n\n    if (children.length) {\n      // create empty fragment\n      const fragment = (doc || document).createDocumentFragment();\n      children.forEach((child: DisplayObject) => {\n        if (child.isConnected) {\n          const $el = ((child as any).elementSVG as ElementSVG).$groupEl;\n          if ($el) {\n            fragment.appendChild($el);\n          }\n        }\n      });\n\n      $groupEl.appendChild(fragment);\n    }\n  }\n\n  applyTransform($el: SVGElement, rts: mat4) {\n    const matrix = `matrix(${numberToLongString(rts[0])},${numberToLongString(\n      rts[1],\n    )},${numberToLongString(rts[4])},${numberToLongString(\n      rts[5],\n    )},${numberToLongString(rts[12])},${numberToLongString(rts[13])})`;\n\n    if (matrix !== $el.getAttribute('transform')) {\n      // use proper precision avoiding too long string in `transform`\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n      $el.setAttribute('transform', matrix);\n    }\n    if (matrix === DEFAULT_VALUE_MAP.transform) {\n      $el.removeAttribute('transform');\n    }\n  }\n\n  private applyAttributes(object: DisplayObject) {\n    const elementSVG = (object as any).elementSVG as ElementSVG;\n    const $el = elementSVG?.$el;\n    const $groupEl = elementSVG?.$groupEl;\n    if ($el && $groupEl) {\n      const { nodeName, attributes } = object;\n\n      if (nodeName !== Shape.HTML) {\n        $el.setAttribute('fill', 'none');\n      }\n      if (nodeName === Shape.IMAGE) {\n        $el.setAttribute('preserveAspectRatio', 'none');\n      }\n\n      // apply attributes\n      this.updateAttribute(object, Object.keys(attributes));\n    }\n  }\n\n  private updateAttribute(object: DisplayObject, attributes: string[]) {\n    const { document } = this.context.config;\n\n    const { $el, $hitTestingEl } = (object as any).elementSVG as ElementSVG;\n    const { parsedStyle, nodeName } = object;\n    const shouldUpdateElementAttribute = attributes.some((name) =>\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.shouldUpdateElementAttribute(\n        object,\n        name,\n      ),\n    );\n\n    // need re-generate path\n    if (shouldUpdateElementAttribute && $el) {\n      [$el, $hitTestingEl].forEach(($el) => {\n        if ($el) {\n          // @ts-ignore\n          this.context.SVGElementLifeCycleContribution.updateElementAttribute(\n            object,\n            $el,\n            this.svgElementMap,\n          );\n        }\n      });\n    }\n\n    // update common attributes\n    attributes.forEach((name) => {\n      const usedName = SVG_ATTR_MAP[name];\n      const computedValue = parsedStyle[name];\n      const computedValueStr =\n        !isNil(computedValue) && computedValue.toString();\n      const formattedValueStr =\n        FORMAT_VALUE_MAP[name]?.[computedValueStr] || computedValueStr;\n      const usedValue = parsedStyle[name];\n      const inherited = usedName && !!propertyMetadataCache[name]?.inh;\n\n      // <foreignObject>\n      if (nodeName === Shape.HTML) {\n        if (name === 'fill') {\n          $el.style.background = usedValue.toString();\n        } else if (name === 'stroke') {\n          $el.style['border-color'] = usedValue.toString();\n          $el.style['border-style'] = 'solid';\n        } else if (name === 'lineWidth') {\n          $el.style['border-width'] = `${usedValue || 0}px`;\n        } else if (name === 'lineDash') {\n          $el.style['border-style'] = 'dashed';\n        } else if (name === 'innerHTML') {\n          this.createOrUpdateInnerHTML(document, $el, usedValue);\n        } else if (\n          name === 'width' ||\n          name === 'height' ||\n          name === 'class' ||\n          name === 'x' ||\n          name === 'y'\n        ) {\n          // width & height are both required for <foreignObject> and cannot be used as style.\n          $el.setAttribute(name, usedValue.toString());\n        } else if (!isNil(object.style[name]) && object.style[name] !== '') {\n          $el.style[name] = object.style[name];\n        }\n      } else {\n        if (\n          !usedName ||\n          ((nodeName === Shape.GROUP || object.isCustomElement) &&\n            (inherited || usedName === 'fill' || usedName === 'stroke'))\n        ) {\n          return;\n        }\n\n        if (name === 'fill') {\n          this.defElementManager.createOrUpdateGradientAndPattern(\n            object,\n            $el,\n            usedValue,\n            usedName,\n            this,\n          );\n        } else if (name === 'stroke') {\n          this.defElementManager.createOrUpdateGradientAndPattern(\n            object,\n            $el,\n            usedValue,\n            usedName,\n            this,\n          );\n        } else if (name === 'clipPath') {\n          this.createOrUpdateClipOrTextPath(document, usedValue, object);\n        } else if (name === 'textPath') {\n          this.createOrUpdateClipOrTextPath(document, usedValue, object, true);\n        } else if (\n          name === 'shadowType' ||\n          name === 'shadowColor' ||\n          name === 'shadowBlur' ||\n          name === 'shadowOffsetX' ||\n          name === 'shadowOffsetY'\n        ) {\n          this.defElementManager.createOrUpdateShadow(object, $el, name);\n        } else if (name === 'filter') {\n          this.defElementManager.createOrUpdateFilter(object, $el, usedValue);\n        } else if (!isNil(computedValue)) {\n          // use computed value so that we can use cascaded effect in SVG\n          // ignore 'unset' and default value\n          [$el, $hitTestingEl].forEach(($el: SVGElement) => {\n            if ($el && usedName) {\n              if (\n                computedValueStr !== 'unset' &&\n                computedValueStr !== DEFAULT_VALUE_MAP[name]\n              ) {\n                $el.setAttribute(usedName, formattedValueStr);\n              } else {\n                $el.removeAttribute(usedName);\n              }\n            }\n          });\n        }\n      }\n    });\n  }\n\n  createSVGDom(\n    document: Document,\n    object: DisplayObject,\n    root: SVGElement,\n    noWrapWithGroup = false,\n  ) {\n    // create svg element\n    // @ts-ignore\n    object.elementSVG = new ElementSVG();\n    // @ts-ignore\n    const svgElement = object.elementSVG;\n\n    // use <group> as default, eg. CustomElement\n    const $el =\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.createElement(\n        object,\n        this.svgElementMap,\n      );\n    if ($el) {\n      let $groupEl: SVGElement;\n\n      // save $el on parsedStyle, which will be returned in getDomElement()\n      if (object.nodeName === Shape.HTML) {\n        object.parsedStyle.$el = $el;\n      }\n\n      if (this.pluginOptions.outputSVGElementId) {\n        // use user-defined id first.\n        $el.id = this.getId(object);\n      }\n      if (this.pluginOptions.outputSVGElementName && object.name) {\n        $el.setAttribute('name', object.name);\n      }\n\n      if (\n        ($el.hasAttribute('data-wrapgroup') || $el.nodeName !== 'g') &&\n        !noWrapWithGroup\n      ) {\n        $groupEl = createSVGElement('g', document);\n        // if (this.pluginOptions.outputSVGElementId) {\n        //   $groupEl.id = $el.id + '-g';\n        // }\n        $groupEl.appendChild($el);\n      } else {\n        $groupEl = $el;\n      }\n\n      svgElement.$el = $el;\n      svgElement.$groupEl = $groupEl;\n\n      // apply attributes at first time\n      this.applyAttributes(object);\n\n      // create hitArea if necessary\n      this.createOrUpdateHitArea(object, $el, $groupEl);\n\n      const $parentGroupEl =\n        root ||\n        // @ts-ignore\n        (object.parentNode && object.parentNode.elementSVG?.$groupEl);\n\n      if ($parentGroupEl) {\n        $parentGroupEl.appendChild($groupEl);\n\n        // need reorder children later\n        this.pendingReorderQueue.add(object.parentNode as DisplayObject);\n      }\n    }\n  }\n\n  private removeSVGDom(object: DisplayObject) {\n    // @ts-ignore\n    const $groupEl = object.elementSVG?.$groupEl;\n    if ($groupEl && $groupEl.parentNode) {\n      $groupEl.parentNode.removeChild($groupEl);\n\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.destroyElement(\n        object,\n        $groupEl,\n      );\n      // object.entity.removeComponent(ElementSVG, true);\n    }\n  }\n\n  private createOrUpdateHitArea(\n    object: DisplayObject,\n    $el: SVGElement,\n    $groupEl: SVGElement,\n  ) {\n    const svgElement = (object as any).elementSVG as ElementSVG;\n    let { $hitTestingEl } = svgElement;\n    const increasedLineWidthForHitTesting = Number(\n      object.parsedStyle.increasedLineWidthForHitTesting,\n    );\n\n    // account for hitArea\n    if (increasedLineWidthForHitTesting) {\n      if (!$hitTestingEl) {\n        $hitTestingEl = $el.cloneNode() as SVGElement;\n        // clear attributes like `filter` `font-size`\n        ['filter'].forEach((attribute) => {\n          $hitTestingEl.removeAttribute(attribute);\n        });\n        // hitArea should be 'transparent' but not 'none'\n        const hasFill = $el.getAttribute('fill') !== 'none';\n        $hitTestingEl.setAttribute('fill', hasFill ? 'transparent' : 'none');\n        $hitTestingEl.setAttribute('stroke', 'transparent');\n        $groupEl.appendChild($hitTestingEl);\n        svgElement.$hitTestingEl = $hitTestingEl;\n\n        // g-plugin-svg-picker will use this map to find target object\n        this.svgElementMap.set($hitTestingEl, object);\n      }\n\n      // increase interactive line width\n      $hitTestingEl.setAttribute(\n        'stroke-width',\n        `${increasedLineWidthForHitTesting + object.parsedStyle.lineWidth}`,\n      );\n    } else if ($hitTestingEl) {\n      $groupEl.removeChild($hitTestingEl);\n      svgElement.$hitTestingEl = null;\n    }\n  }\n\n  private createOrUpdateInnerHTML(\n    doc: Document,\n    $el: SVGElement,\n    usedValue: any,\n  ) {\n    const $div = (doc || document).createElement('div');\n    if (typeof usedValue === 'string') {\n      $div.innerHTML = usedValue;\n    } else {\n      $div.appendChild(usedValue);\n    }\n    $el.innerHTML = '';\n    $el.appendChild($div);\n  }\n\n  private createOrUpdateClipOrTextPath(\n    document: Document,\n    clipPath: DisplayObject,\n    object: DisplayObject,\n    isTextPath = false,\n  ) {\n    const { $groupEl } = (object as any).elementSVG as ElementSVG;\n    const PREFIX = isTextPath ? TEXT_PATH_PREFIX : CLIP_PATH_PREFIX;\n    const attributeNameCamel = isTextPath ? 'g' : 'clipPath';\n    const attributeNameHyphen = isTextPath ? 'text-path' : 'clip-path';\n\n    if (clipPath) {\n      const clipPathId = `${PREFIX + clipPath.entity}-${object.entity}`;\n      const $def = this.defElementManager.getDefElement();\n\n      const existed = $def.querySelector(`#${clipPathId}`);\n      if (!existed) {\n        let $clipPath: SVGElement;\n        if (isTextPath) {\n          // use <path> directly instead of wrapping with <g>\n          this.createSVGDom(document, clipPath, null, true);\n          // @ts-ignore\n          $clipPath = clipPath.elementSVG.$el;\n        } else {\n          // the clipPath is allowed to be detached from canvas\n          if (!clipPath.isConnected) {\n            const $existedClipPath = $def.querySelector(\n              `#${this.getId(clipPath)}`,\n            );\n            if (!$existedClipPath) {\n              this.createSVGDom(document, clipPath, $def, true);\n            }\n          }\n\n          // create <clipPath> dom node\n          $clipPath = createSVGElement(attributeNameCamel, document);\n          const $use = createSVGElement('use', document) as SVGUseElement;\n          // @ts-ignore\n          $use.setAttribute('href', `#${clipPath.elementSVG.$el.id}`);\n          $clipPath.appendChild($use);\n\n          let $useRefs = this.clipPathUseMap.get(clipPath);\n          if (!$useRefs) {\n            this.clipPathUseMap.set(clipPath, []);\n            $useRefs = this.clipPathUseMap.get(clipPath);\n          }\n          $useRefs.push($use);\n\n          // <clipPath transform=\"matrix()\"><circle /></clipPath>\n          this.applyTransform($use, clipPath.getWorldTransform());\n          const parentInvert = mat4.invert(\n            mat4.create(),\n            object.getWorldTransform(),\n          );\n          this.applyTransform($clipPath, parentInvert);\n        }\n\n        if (this.pluginOptions.outputSVGElementId) {\n          $clipPath.id = clipPathId;\n        }\n        // append it to <defs>\n        $def.appendChild($clipPath);\n      }\n\n      // apply attributes\n      this.applyAttributes(clipPath);\n\n      if (!isTextPath) {\n        // apply clipPath to $group\n        // @see https://github.com/antvis/g/issues/961\n        $groupEl.setAttribute(attributeNameHyphen, `url(#${clipPathId})`);\n      }\n    } else if (!isTextPath) {\n      // remove clip path\n      $groupEl.removeAttribute(attributeNameHyphen);\n    }\n  }\n}\n","import type { GlobalRuntime, ParsedTextStyleProps, Text } from '@antv/g-lite';\nimport { TEXT_PATH_PREFIX } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { convertHTML } from '../../utils/format';\n\n// @see https://github.com/plouc/nivo/issues/164\nconst BASELINE_MAP: Record<string, string> = {\n  top: 'hanging', // Use hanging here.\n  middle: 'central',\n  bottom: 'text-after-edge', // FIXME: It is not a standard property.\n  alphabetic: 'alphabetic',\n  ideographic: 'ideographic',\n  hanging: 'hanging',\n};\n\nexport function updateTextElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedTextStyleProps,\n  text: Text,\n  runtime: GlobalRuntime,\n) {\n  // Trigger text geometry calculation.\n  text.getBounds();\n  const {\n    lineWidth = 1,\n    x = 0,\n    y = 0,\n    dx = 0,\n    dy = 0,\n    textPath,\n    textPathSide = 'left',\n    textPathStartOffset = 0,\n    textDecorationLine = '',\n    textDecorationColor = '',\n    textDecorationStyle = '',\n    textDecorationThickness = 1,\n    metrics,\n  } = parsedStyle;\n  let { textBaseline = 'alphabetic' } = parsedStyle;\n\n  if (textBaseline === 'alphabetic') {\n    textBaseline = 'bottom';\n  }\n\n  $el.setAttribute('dominant-baseline', BASELINE_MAP[textBaseline]);\n\n  $el.setAttribute('paint-order', 'stroke');\n\n  const { lines, lineHeight, height } = metrics;\n\n  const lineNum = lines.length;\n\n  let styleCSSText = `transform:translate(${dx}px, ${dy}px);`;\n  if (textDecorationLine && textDecorationLine !== 'none') {\n    // Use CSS text-decoration for basic support\n    styleCSSText += `text-decoration:${textDecorationLine} ${textDecorationStyle} ${textDecorationColor};text-decoration-thickness:${textDecorationThickness};`;\n  }\n\n  if (styleCSSText) {\n    $el.setAttribute('style', styleCSSText);\n  }\n  if (x !== 0) {\n    $el.setAttribute('x', `${x}`);\n  }\n  if (y !== 0) {\n    $el.setAttribute('y', `${y}`);\n  }\n\n  if (lineNum === 1) {\n    const textContent = convertHTML(lines[0]);\n    $el.setAttribute('dx', `${lineWidth / 2}`);\n\n    // Since `text-after-edge` is not a standard property value, we use `dy` instead.\n    if (textBaseline === 'bottom' || textBaseline === 'top') {\n      $el.setAttribute('dominant-baseline', BASELINE_MAP.middle);\n      $el.setAttribute(\n        'dy',\n        textBaseline === 'bottom' ? `-${height / 2}px` : `${height / 2}px`,\n      );\n    } else {\n      $el.setAttribute('dy', '0px');\n    }\n\n    // <textPath> only support one line\n    // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/textPath\n    if (textPath) {\n      // clear existed text content first\n      $el.innerHTML = '';\n\n      // append <textPath href=\"#MyPath\">text</textPath>\n      const $textPath = createSVGElement('textPath', $el.ownerDocument);\n      $textPath.setAttribute('href', `#${TEXT_PATH_PREFIX + textPath.entity}`);\n      if (textPathSide !== 'left') {\n        $textPath.setAttribute('side', textPathSide);\n      }\n      if (textPathStartOffset !== 0) {\n        $textPath.setAttribute('startOffset', `${textPathStartOffset}`);\n      }\n      $textPath.innerHTML = textContent;\n      $el.appendChild($textPath);\n    } else {\n      $el.innerHTML = textContent;\n    }\n  } else {\n    $el.innerHTML = lines\n      .map((line: string, i: number) => {\n        const dx = lineWidth / 2;\n        let dy = 0;\n        if (i === 0) {\n          // TODO: handle other textBaseline values\n          if (textBaseline === 'middle') {\n            dy = lineHeight / 2 - height / 2;\n          } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n            dy = 0;\n          } else if (\n            textBaseline === 'bottom' ||\n            textBaseline === 'ideographic'\n          ) {\n            dy = -lineHeight * (lineNum - 1);\n          }\n        } else {\n          dy = lineHeight;\n        }\n        return `<tspan x=${x} dx=\"${dx}\" dy=\"${dy}\">${convertHTML(\n          line,\n        )}</tspan>`;\n      })\n      .join('');\n  }\n}\n","import type {\n  CanvasContext,\n  DisplayObject,\n  GlobalRuntime,\n  Text,\n} from '@antv/g-lite';\nimport { Shape } from '@antv/g-lite';\nimport {\n  updateImageElementAttribute,\n  updateLineElementAttribute,\n  updatePathElementAttribute,\n  updatePolylineElementAttribute,\n  updateRectElementAttribute,\n  updateTextElementAttribute,\n} from './shapes/paths';\nimport type { ElementLifeCycleContribution } from './interfaces';\nimport { createSVGElement } from './utils/dom';\n\nexport const SHAPE2TAGS: Record<Shape | string, string> = {\n  [Shape.RECT]: 'path',\n  [Shape.CIRCLE]: 'circle',\n  [Shape.ELLIPSE]: 'ellipse',\n  [Shape.IMAGE]: 'image',\n  [Shape.GROUP]: 'g',\n  [Shape.LINE]: 'line',\n  [Shape.POLYLINE]: 'polyline',\n  [Shape.POLYGON]: 'polygon',\n  [Shape.TEXT]: 'text',\n  [Shape.PATH]: 'path',\n  [Shape.HTML]: 'foreignObject',\n};\n\nexport const SHAPE_UPDATE_DEPS: Record<Shape | string, string[]> = {\n  [Shape.CIRCLE]: ['cx', 'cy', 'r'],\n  [Shape.ELLIPSE]: ['cx', 'cy', 'rx', 'ry'],\n  [Shape.RECT]: ['x', 'y', 'width', 'height', 'radius'],\n  [Shape.IMAGE]: ['x', 'y', 'src', 'width', 'height'],\n  [Shape.LINE]: [\n    'x1',\n    'y1',\n    'x2',\n    'y2',\n    'markerStart',\n    'markerEnd',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.POLYLINE]: [\n    'points',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.POLYGON]: [\n    'points',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.PATH]: [\n    'd',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.TEXT]: [\n    'text',\n    'font',\n    'fontSize',\n    'fontFamily',\n    'fontStyle',\n    'fontWeight',\n    'fontVariant',\n    'lineHeight',\n    'letterSpacing',\n    'wordWrap',\n    'wordWrapWidth',\n    'maxLines',\n    'leading',\n    'textBaseline',\n    'textAlign',\n    'textTransform',\n    'textOverflow',\n    'textPath',\n    'textPathSide',\n    'textPathStartOffset',\n    'textDecorationLine',\n    'textDecorationColor',\n    'textDecorationStyle',\n    // 'whiteSpace',\n    'dx',\n    'dy',\n  ],\n};\n\nexport class DefaultElementLifeCycleContribution\n  implements ElementLifeCycleContribution\n{\n  constructor(\n    private context: CanvasContext,\n    private runtime: GlobalRuntime,\n  ) {}\n\n  createElement(\n    object: DisplayObject,\n    svgElementMap: WeakMap<SVGElement, DisplayObject>,\n  ): SVGElement {\n    const { document: doc } = this.context.config;\n\n    const type = SHAPE2TAGS[object.nodeName] || 'g';\n    const $el = createSVGElement(type, doc || document);\n\n    svgElementMap.set($el, object);\n    return $el;\n  }\n\n  destroyElement(object: DisplayObject, $el: SVGElement) {}\n\n  shouldUpdateElementAttribute(object: DisplayObject, attributeName: string) {\n    const { nodeName } = object;\n    return (SHAPE_UPDATE_DEPS[nodeName] || []).indexOf(attributeName) > -1;\n  }\n\n  updateElementAttribute(object: DisplayObject) {\n    // @ts-ignore\n    const { $el } = object.elementSVG as ElementSVG;\n    const { nodeName, parsedStyle } = object;\n\n    switch (nodeName) {\n      case Shape.IMAGE: {\n        updateImageElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.RECT: {\n        updateRectElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.LINE: {\n        updateLineElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.POLYGON:\n      case Shape.POLYLINE: {\n        updatePolylineElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.PATH: {\n        updatePathElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.TEXT: {\n        updateTextElementAttribute(\n          $el,\n          parsedStyle,\n          object as Text,\n          this.runtime,\n        );\n        break;\n      }\n    }\n  }\n}\n","import { AbstractRendererPlugin, GlobalRuntime } from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { ElementSVG } from './components/ElementSVG';\nimport { DefaultElementLifeCycleContribution } from './DefaultElementLifeCycleContribution';\nimport { DefElementManager } from './shapes/defs';\nimport { SVGRendererPlugin } from './SVGRendererPlugin';\nimport type { SVGRendererPluginOptions } from './interfaces';\n\nexport * from './DefaultElementLifeCycleContribution';\nexport * from './shapes/paths';\nexport * from './SVGRendererPlugin';\nexport * from './interfaces';\nexport * from './utils/dom';\nexport { ElementSVG };\n\nexport class Plugin extends AbstractRendererPlugin {\n  name = 'svg-renderer';\n\n  constructor(private options: Partial<SVGRendererPluginOptions> = {}) {\n    super();\n  }\n\n  init(runtime: GlobalRuntime): void {\n    const { outputSVGElementId, outputSVGElementName } = this.options;\n    const defElementManager = new DefElementManager(this.context);\n\n    // default implementation\n    const defaultElementLifeCycleContribution =\n      new DefaultElementLifeCycleContribution(this.context, runtime);\n    // @ts-ignore\n    this.context.defaultElementLifeCycleContribution =\n      defaultElementLifeCycleContribution;\n\n    // @ts-ignore\n    this.context.SVGElementLifeCycleContribution =\n      defaultElementLifeCycleContribution;\n\n    const SVGRendererPluginOptions: SVGRendererPluginOptions = {\n      outputSVGElementId: !isNil(outputSVGElementId)\n        ? !!outputSVGElementId\n        : true,\n      outputSVGElementName: !isNil(outputSVGElementName)\n        ? !!outputSVGElementName\n        : true,\n    };\n\n    this.addRenderingPlugin(\n      // @ts-ignore\n      new SVGRendererPlugin(\n        SVGRendererPluginOptions,\n        defElementManager,\n        this.context,\n      ),\n    );\n  }\n  destroy(): void {\n    this.removeAllRenderingPlugins();\n\n    // @ts-ignore\n    delete this.context.defaultElementLifeCycleContribution;\n    // @ts-ignore\n    delete this.context.SVGElementLifeCycleContribution;\n  }\n}\n","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn.js\";\nfunction _callSuper(t, o, e) {\n  return o = getPrototypeOf(o), possibleConstructorReturn(t, isNativeReflectConstruct() ? Reflect.construct(o, e || [], getPrototypeOf(t).constructor) : o.apply(t, e));\n}\nexport { _callSuper as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nexport { _inherits as default };"],"names":["_classCallCheck","a","n","TypeError","_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","_getPrototypeOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_isNativeReflectConstruct","Boolean","valueOf","Reflect","construct","_possibleConstructorReturn","ReferenceError","assertThisInitialized","_setPrototypeOf","isNil","value","isString","clamp$1","min","max","ARRAY_TYPE","Float32Array","Array","create","out","glMatrix.ARRAY_TYPE","invert","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","ElementSVG","_defineProperty","updateImageElementAttribute","$el","parsedStyle","_parsedStyle$src","src","_parsedStyle$x","x","_parsedStyle$y","y","width","height","setAttribute","concat","Image","HTMLElement","nodeName","toUpperCase","toDataURL","ImageData","canvas","document","createElement","context","getContext","putImageData","updateLineElementAttribute","x1","y1","x2","y2","markerStart","markerEnd","markerStartOffset","markerEndOffset","startOffsetX","startOffsetY","endOffsetX","endOffsetY","rad","isDisplayObject","Math","cos","atan2","sin","_arrayLikeToArray","_slicedToArray","isArray","arrayWithHoles","l","u","f","next","done","push","iterableToArrayLimit","arrayLikeToArray","toString","slice","name","from","test","unsupportedIterableToArray","nonIterableRest","updatePathElementAttribute","d","_getStartTangent2","parentNode","getStartTangent","p1","p2","_getEndTangent2","getEndTangent","translatePathToString","absolutePath","updatePolylineElementAttribute","points","map","point","offsetX","offsetY","join","updateRectElementAttribute","radius","isFinite","some","_radius$map2","clamp","abs","tlr","trr","brr","blr","signX","signY","sweepFlag","createSVGElement","type","doc","createElementNS","tag","FILTER_PREFIX","createOrUpdateFilter","$def","object","filters","filterName","entity","$existedFilters","querySelectorAll","forEach","$filter","removeChild","removeAttribute","filterIds","_ref","params","$feGaussianBlur","appendChild","createBlur","slope","convertToAbsoluteValue","createFeComponentTransfer","intercept","createBrightness","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","formatted","$feOffset","$feFlood","$feComposite","$feMerge","$feMergeNode1","$feMergeNode2","createDropShadow","createContrast","amount","createFeColorMatrix","createGrayscale","createSepia","$feColorMatrix","createSaturate","createHueRotate","tableValues","createInvert","id","setTimeout","filterId","param","unit","UnitType","kPercentage","_ref2","$feComponentTransfer","$feFunc","matrix","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","apply","_objectSpread2","arguments","getOwnPropertyDescriptors","defineProperties","cacheKey2IDMap","counter","createOrUpdateGradientAndPattern","parsedColor","createImage","plugin","isCSSRGB","isPattern","patternId","pattern","generateCacheKey","$existed","querySelector","image","imageURL","isBrowser","HTMLImageElement","HTMLCanvasElement","$image","img","match","crossOrigin","onload","$pattern","create$Pattern","complete","_parsedStyle","createSVGDom","svgElement","elementSVG","localTransform","getLocalTransform","applyTransform","$groupEl","createOrUpdatePattern","style","gradientId","createOrUpdateGradient","gradients","blended","gradient","rectId","$rect","$feImage","$feBlend","createOrUpdateMultiGradient","isNone","options","undefined","cacheKey","isCSSGradientValue","GradientType","LinearGradient","RadialGradient","_value$options","_objectSpread","steps","angle","cx","cy","size","color","offset","repetition","transform","parseTransform","parsed","newScale","s","newSkew","_d$map2","b","c","dd","tx","ty","item","formatTransform","_object$getGeometryBo","getGeometryBounds","halfExtents","patternWidth","patternHeight","bounds","innerHTML","sort","_computeLinearGradien","computeLinearGradient","_ref4","_computeRadialGradien","computeRadialGradient","urlRegexp","DefElementManager","this","gradientCache","config","$svg","contextService","_this","clearUnusedDefElement","cache","has","targetElement","_this$context$config","matches","getAttribute","replace","newDefElementId","Set","add","_object$parsedStyle","_object$parsedStyle$s","shadowType","hasShadow","shadowId","$existedFilter","remove","$feDropShadow","$feFuncA","$feComposite2","$feMergeNode","children","createOrUpdateShadow","numberToLongString","toFixed","convertHTML","str","SVG_ATTR_MAP","opacity","fillStyle","fill","fillRule","fillOpacity","strokeStyle","strokeOpacity","stroke","clipPath","textPath","rx","ry","lineCap","lineJoin","lineWidth","lineDash","lineDashOffset","miterLimit","font","fontSize","fontStyle","fontVariant","fontWeight","fontFamily","letterSpacing","startArrow","endArrow","class","preserveAspectRatio","visibility","textAlign","pointerEvents","FORMAT_VALUE_MAP","inherit","left","start","center","right","end","DEFAULT_VALUE_MAP","strokeWidth","strokeMiterLimit","G_SVG_PREFIX","CLIP_PATH_PREFIX","TEXT_PATH_PREFIX","SVGRendererPlugin","pluginOptions","defElementManager","svgElementMap","WeakMap","renderQueue","dirtyAttributes","pendingReorderQueue","clipPathUseMap","renderingService","renderingContext","root","ownerDocument","defaultView","handleMounted","target","get","existed","getDefElement","getId","$camera","handleUnmounted","clear","removeSVGDom","reorderChildren","_object$parentNode","parent","handleReparent","handleAttributeChanged","attrName","attribtues","set","handleGeometryBoundsChanged","records","detail","_loop","Shape","FRAGMENT","childNodes","node","_object$elementSVG","parentInvert","mat4","getWorldTransform","clipPathId","hooks","init","tap","background","camera","getOrthoMatrix","addEventListener","ElementEvent","MOUNTED","UNMOUNTED","REPARENT","ATTR_MODIFIED","BOUNDS_CHANGED","destroy","removeEventListener","render","beginFrame","_object$elementSVG2","$parentGroupEl","endFrame","renderReasons","RenderReason","CAMERA_CHANGED","_elementSVG","_elementSVG2","$useRefs","$use","renderable","dirty","attributes","createOrUpdateHitArea","updateAttribute","sortable","renderOrder","fragment","createDocumentFragment","child","isConnected","rts","HTML","IMAGE","_this2","$hitTestingEl","SVGElementLifeCycleContribution","shouldUpdateElementAttribute","updateElementAttribute","_FORMAT_VALUE_MAP$nam","_propertyMetadataCach","usedName","computedValue","computedValueStr","formattedValueStr","usedValue","inherited","propertyMetadataCache","inh","createOrUpdateInnerHTML","GROUP","isCustomElement","createOrUpdateClipOrTextPath","noWrapWithGroup","_object$parentNode$el","outputSVGElementId","outputSVGElementName","hasAttribute","applyAttributes","_object$elementSVG3","destroyElement","increasedLineWidthForHitTesting","cloneNode","attribute","hasFill","$div","isTextPath","attributeNameCamel","attributeNameHyphen","$clipPath","BASELINE_MAP","top","middle","bottom","alphabetic","ideographic","hanging","updateTextElementAttribute","text","runtime","getBounds","_parsedStyle$lineWidt","_parsedStyle$dx","dx","_parsedStyle$dy","dy","_parsedStyle$textPath","textPathSide","_parsedStyle$textPath2","textPathStartOffset","_parsedStyle$textDeco","textDecorationLine","_parsedStyle$textDeco2","textDecorationColor","_parsedStyle$textDeco3","textDecorationStyle","_parsedStyle$textDeco4","textDecorationThickness","metrics","_parsedStyle$textBase","textBaseline","lines","lineHeight","lineNum","styleCSSText","textContent","$textPath","line","SHAPE2TAGS","_SHAPE2TAGS","RECT","CIRCLE","ELLIPSE","LINE","POLYLINE","POLYGON","TEXT","PATH","SHAPE_UPDATE_DEPS","DefaultElementLifeCycleContribution","attributeName","indexOf","Plugin","_AbstractRendererPlug","possibleConstructorReturn","isNativeReflectConstruct","_inherits","_this$options","defaultElementLifeCycleContribution","SVGRendererPluginOptions","addRenderingPlugin","removeAllRenderingPlugins","AbstractRendererPlugin"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,16,19,20,21,22,23,24,30,39,40]}